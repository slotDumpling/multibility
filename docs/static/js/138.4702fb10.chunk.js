(self.webpackChunkmultibility=self.webpackChunkmultibility||[]).push([[138,701],{64309:function(t,e,n){"use strict";function r(t,e){var n=document.createElement("canvas"),r=n.getContext("2d");if(!r)throw new Error("can't get virtual canvas context");return n.width=t,n.height=e,{canvas:n,context:r}}function a(t){t.width=1,t.height=1;var e=t.getContext("2d");null===e||void 0===e||e.clearRect(0,0,1,1)}n.d(e,{j:function(){return a},v:function(){return r}})},21176:function(t,e,n){"use strict";n.r(e),n.d(e,{LoadPDF:function(){return M},getOneImage:function(){return I},getOnePageImage:function(){return C},getPDFImages:function(){return b}});var r=n(1413),a=n(29439),u=n(37762),c=n(93433),s=n(15861),i=n(87757),o=n.n(i),f=n(61842),p=n.n(f),h=n(62560),l=n(20434),x=n.n(l),v=n(24610),m=n(64309),g=n(92198);h.GlobalWorkerOptions.workerSrc=x();var w=function(){var t=(0,s.Z)(o().mark((function t(e){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Uint8Array,t.next=3,e.arrayBuffer();case 3:return t.t1=t.sent,n=new t.t0(t.t1),t.abrupt("return",h.getDocument(n).promise);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(){var t=(0,s.Z)(o().mark((function t(e,n,r){var a,u,c,s,i,f,p,h,l;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getPage(n);case 2:return a=t.sent,u=a.getViewport({scale:r}),console.log({viewport:u}),c=u.height,s=u.width,i=c/s,f=(0,m.v)(Math.floor(s*r),Math.floor(c*r)),p=f.canvas,h=f.context,t.next=10,a.render({canvasContext:h,viewport:u,transform:[r,0,0,r,0,0]}).promise;case 10:return l=p.toDataURL(),(0,m.j)(p),t.abrupt("return",[l,i]);case 13:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}();function b(t){return k.apply(this,arguments)}function k(){return k=(0,s.Z)(o().mark((function t(e){var n,r,u,c,s,i,f,p,h,l,x,v=arguments;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=v.length>1&&void 0!==v[1]?v[1]:2,r=v.length>2?v[2]:void 0,t.next=4,w(e);case 4:u=t.sent,c=u.numPages,s=[],i=[],f=1;case 9:if(!(f<=c)){t.next=22;break}return t.next=12,d(u,f,n);case 12:p=t.sent,h=(0,a.Z)(p,2),l=h[0],x=h[1],s.push(l),i.push(x),r&&r(Math.floor(f/c*100));case 19:f+=1,t.next=9;break;case 22:return t.abrupt("return",{images:s,ratios:i});case 23:case"end":return t.stop()}}),t)}))),k.apply(this,arguments)}function I(t,e){return y.apply(this,arguments)}function y(){return y=(0,s.Z)(o().mark((function t(e,n){var r,u,c,s,i,f,p=arguments;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=p.length>2&&void 0!==p[2]?p[2]:2,t.next=3,w(e);case 3:if(u=t.sent,c=u.numPages,!(n>c)){t.next=7;break}throw new Error("index out of range");case 7:return t.next=9,d(u,n,r);case 9:return s=t.sent,i=(0,a.Z)(s,1),f=i[0],t.abrupt("return",f);case 13:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}var Z=function(){var t=(0,s.Z)(o().mark((function t(e,n){var r,a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p().getItem("IMAGE_CACHE");case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0=[];case 5:if(r=t.t0,a="IMAGE_".concat(e,"_").concat(n),r.includes(a)){t.next=9;break}return t.abrupt("return");case 9:return r=[a].concat((0,c.Z)(r.filter((function(t){return t!==a})))),t.next=12,p().setItem("IMAGE_CACHE",r);case 12:return t.next=14,p().getItem(a);case 14:return t.abrupt("return",t.sent);case 15:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),E=function(){var t=(0,s.Z)(o().mark((function t(e,n,r){var a,s,i,f,h,l;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p().getItem("IMAGE_CACHE");case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0=[];case 5:if(a=t.t0,s="IMAGE_".concat(e,"_").concat(n),a=[s].concat((0,c.Z)(a.filter((function(t){return t!==s})))),!(a.length>10)){t.next=28;break}i=a.slice(10),a=a.slice(0,10),f=(0,u.Z)(i),t.prev=12,f.s();case 14:if((h=f.n()).done){t.next=20;break}return l=h.value,t.next=18,p().removeItem(l);case 18:t.next=14;break;case 20:t.next=25;break;case 22:t.prev=22,t.t1=t.catch(12),f.e(t.t1);case 25:return t.prev=25,f.f(),t.finish(25);case 28:return t.next=30,p().setItem("IMAGE_CACHE",a);case 30:return t.next=32,p().setItem(s,r);case 32:case"end":return t.stop()}}),t,null,[[12,22,25,28]])})));return function(e,n,r){return t.apply(this,arguments)}}();function C(t,e){return A.apply(this,arguments)}function A(){return(A=(0,s.Z)(o().mark((function t(e,n){var r,a,u;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Z(e,n);case 2:if(!(r=t.sent)){t.next=5;break}return t.abrupt("return",r);case 5:return t.next=7,p().getItem("PDF_".concat(e));case 7:if(a=t.sent,t.t0=a,!t.t0){t.next=13;break}return t.next=12,I(a,n,2);case 12:t.t0=t.sent;case 13:return(u=t.t0)&&E(e,n,u),t.abrupt("return",u);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function M(t,e){return _.apply(this,arguments)}function _(){return(_=(0,s.Z)(o().mark((function t(e,n){var a,u,c,s,i,f,p,h;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b(e,.5,n);case 2:return a=t.sent,u=a.images,c=a.ratios,s={},i=[],u.forEach((function(t,e){var n=(0,v.v4)();s[n]={image:t,ratio:c[e],state:{strokes:{}},pdfIndex:e+1},i.push(n)})),f=e.name.replace(".pdf",""),t.next=11,e.arrayBuffer();case 11:return p=t.sent,h=new Blob([p],{type:"application/pdf"}),t.abrupt("return",(0,r.Z)((0,r.Z)({},(0,g.X)()),{},{name:f,withImg:!0,pdf:h,thumbnail:u[0],pageRec:s,pageOrder:i}));case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},14601:function(){},32767:function(){},28251:function(){},57677:function(){},1543:function(){},87324:function(){}}]);
//# sourceMappingURL=138.4702fb10.chunk.js.map