"use strict";(self.webpackChunkmultibility=self.webpackChunkmultibility||[]).push([[426],{35873:function(e,t,n){n.d(t,{W:function(){return c}});var r=n(81694),a=n.n(r),s=n(80184),c=function(e){var t=e.color,n=e.className,r={backgroundColor:t};return(0,s.jsx)("div",{className:a()("color-circle",n),style:r})}},74115:function(e,t,n){n.d(t,{MW:function(){return l},O9:function(){return s},Qk:function(){return c},bM:function(){return u},mr:function(){return i}});var r=n(45917),a=n.n(r),s=["#f97316","#eab308","#84cc16","#22c55e","#10b981","#14b8a6","#06b6d4","#0ea5e9","#3b82f6","#6366f1","#8b5cf6","#a855f7","#d946ef","#ec4899","#f43f5e","#ef4444"],c=[].concat(["#000000","#9ca3af","#64748b","#78716c"],s),i=function(){var e=Math.floor(Math.random()*s.length);return s[e]},u=function(e){var t=a()(e)%s.length;return s[t]},o={"#f97316":{light:"#FFEDD5",dark:"#9A3412"},"#eab308":{light:"#FEF9C3",dark:"#854D0E"},"#84cc16":{light:"#ECFCCB",dark:"#3F6212"},"#22c55e":{light:"#DCFCE7",dark:"#166534"},"#10b981":{light:"#D1FAE5",dark:"#065F46"},"#14b8a6":{light:"#CCFBF1",dark:"#115E59"},"#06b6d4":{light:"#CFFAFE",dark:"#155E75"},"#0ea5e9":{light:"#E0F2FE",dark:"#075985"},"#3b82f6":{light:"#DBEAFE",dark:"#1E40AF"},"#6366f1":{light:"#E0E7FF",dark:"#3730A3"},"#8b5cf6":{light:"#EDE9FE",dark:"#5B21B6"},"#a855f7":{light:"#F3E8FF",dark:"#6B21A8"},"#d946ef":{light:"#FAE8FF",dark:"#86198F"},"#ec4899":{light:"#FCE7F3",dark:"#9D174D"},"#f43f5e":{light:"#FFE4E6",dark:"#9F1239"},"#ef4444":{light:"#FEE2E2",dark:"#991B1B"}},l=function(e){var t,n=null!==(t=o[e])&&void 0!==t?t:{light:"#E5E7EB",dark:"#374151"};return{"--light-color":n.light,"--dark-color":n.dark}}},79856:function(e,t,n){n.d(t,{f:function(){return d}});var r=n(29439),a=n(45987),s=n(15671),c=n(43144),i=n(57293),u=n(24124),o=["pageID"],l={pageStates:(0,u.D5)(),pageInfos:(0,u.D5)()},f=(0,u.WV)(l),d=function(){function e(t){(0,s.Z)(this,e),this.immutable=t}return(0,c.Z)(e,[{key:"getImmutable",value:function(){return this.immutable}},{key:"getPageStates",value:function(){return this.getImmutable().get("pageStates")}},{key:"getPageInfos",value:function(){return this.getImmutable().get("pageInfos")}},{key:"getOneState",value:function(e,t){var n;return null===(n=this.getPageStates().get(e))||void 0===n?void 0:n.get(t)}},{key:"getOnePageStateMap",value:function(e){return this.getPageStates().get(e)}},{key:"getPageRatio",value:function(e){var t;return null===(t=this.getPageInfos().get(e))||void 0===t?void 0:t.ratio}},{key:"includesPage",value:function(e){return this.getPageStates().has(e)}},{key:"setState",value:function(t,n,r){var a=this.getPageStates().get(t);return a?new e(this.getImmutable().update("pageStates",(function(e){return e.set(t,a.set(n,r))}))):this}},{key:"addPage",value:function(t,n){var r=n.ratio;return new e(this.getImmutable().update("pageStates",(function(e){return e.set(t,(0,u.D5)())})).update("pageInfos",(function(e){return e.set(t,{ratio:r})})))}},{key:"pushOperation",value:function(e,t){var n=e.pageID,r=(0,a.Z)(e,o),s=this.getPageRatio(n);if(!this.includesPage(n)||!s)return this;var c=this.getOneState(n,t)||i.Dw.createEmpty(s),u=i.Dw.pushOperation(c,r);return this.setState(n,t,u)}},{key:"resetUser",value:function(e,t){for(var n=this,a=0,s=Object.entries(t);a<s.length;a++){var c=(0,r.Z)(s[a],2),u=c[0],o=c[1],l=o.state,f=o.ratio;n.getOneState(u,e)&&(n=n.setState(u,e,i.Dw.loadFromFlat(l,f)))}return n}}],[{key:"createFromTeamPages",value:function(t){var n=f();return Object.entries(t).forEach((function(e){var t=(0,r.Z)(e,2),a=t[0],s=t[1],c=s.states,o=s.ratio,l=(0,u.D5)(Object.entries(c).map((function(e){var t=(0,r.Z)(e,2),n=t[0],a=t[1];return[n,i.Dw.loadFromFlat(a,o)]})));n=n.update("pageStates",(function(e){return e.set(a,l)})).update("pageInfos",(function(e){return e.set(a,{ratio:o})}))})),new e(n)}},{key:"getValidUsers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,u.l4)();return e?Array.from(e.filter((function(e){return!e.isEmpty()})).deleteAll(t).keys()):[]}},{key:"isEmpty",value:function(e){return!e||e.every((function(e){return e.isEmpty()}))}}]),e}()},52365:function(e,t,n){n.d(t,{LH:function(){return f},kV:function(){return d},mf:function(){return c},s2:function(){return o},zI:function(){return u}});var r=n(29439),a=n(72791),s=n(80184);function c(e){var t=e.propertyName,n=e.active,s=void 0===n||n,c=(0,a.useRef)((function(){})),i=(0,a.useState)((function(){return new Promise((function(e){return c.current=e}))}));return[(0,r.Z)(i,1)[0],function(e){e.propertyName===t&&s&&c.current()}]}var i=(0,a.createContext)(["",function(){}]);function u(){var e=(0,a.useContext)(i);return(0,a.useDebugValue)(e[0]),e}var o=function(e){var t=e.children,n=e.initKey,r=(0,a.useState)(n);return(0,s.jsx)(i.Provider,{value:r,children:t})},l=(0,a.createContext)([!1,function(){}]);function f(){var e=(0,a.useContext)(l);return(0,a.useDebugValue)(e[0]),e}var d=function(e){var t=e.children,n=(0,a.useState)(!1);return(0,s.jsx)(l.Provider,{value:n,children:t})}},51570:function(e,t,n){n.d(t,{CD:function(){return E},_n:function(){return g},dn:function(){return b},f1:function(){return C},fI:function(){return v},ox:function(){return F},r8:function(){return N}});var r,a=n(45987),s=n(74165),c=n(15861),i=n(74569),u=n.n(i),o=n(92198),l=n(75783),f=n(69951),d=n(61842),p=n.n(d),x=n(83329),m=n.n(x),h=["statusCode"],g=null!==(r="https://api.slotdumpling.top/paint")?r:"";function v(e){return Z.apply(this,arguments)}function Z(){return(Z=(0,c.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u().get("code/".concat(t));case 3:if(n=e.sent,200===(r=n.data).statusCode){e.next=7;break}return e.abrupt("return",null);case 7:return e.abrupt("return",r.noteID);case 10:return e.prev=10,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function j(e){return k.apply(this,arguments)}function k(){return(k=(0,c.Z)((0,s.Z)().mark((function e(t){var n,r,c,i,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u().get("info/".concat(t));case 3:if(n=e.sent,r=n.data,i=(c=r).statusCode,o=(0,a.Z)(c,h),200===i){e.next=8;break}return e.abrupt("return",null);case 8:return e.abrupt("return",o);case 11:return e.prev=11,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function b(e,t){return y.apply(this,arguments)}function y(){return(y=(0,c.Z)((0,s.Z)().mark((function e(t,n){var r,a,c,i,o,f;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j(t);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return",null);case 6:return a=r.noteInfo,c=r.pageInfos,e.next=9,(0,l.Rb)(t,a,c);case 9:if(!e.sent){e.next=11;break}return e.abrupt("return",r);case 11:if(!a.withImg){e.next=21;break}return e.next=14,u()({method:"GET",url:t,responseType:"blob",onDownloadProgress:function(e){var t=e.loaded;null===n||void 0===n||n(t)}});case 14:return i=e.sent,o=i.data,f=new Blob([o],{type:"application/pdf"}),e.next=19,(0,l.Vk)(t,a,c,f);case 19:e.next=23;break;case 21:return e.next=23,(0,l.Vk)(t,a,c);case 23:return e.abrupt("return",r);case 26:return e.prev=26,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 30:case"end":return e.stop()}}),e,null,[[0,26]])})))).apply(this,arguments)}function N(e){return S.apply(this,arguments)}function S(){return(S=(0,c.Z)((0,s.Z)().mark((function e(t){var n,r,a,c,i,d,p,x,m,h,g,v;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.U9)(t);case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return r=n.uid,a=n.name,c=n.withImg,i=n.pdf,d=n.pageOrder,p=n.pageRec,(0,o.Yl)(p),e.prev=7,e.next=10,u().put("create/".concat(t),{userID:(0,f.VN)(),pageRec:p,noteInfo:{uid:r,name:a,withImg:c,pageOrder:d}});case 10:if(x=e.sent,m=x.data,!i){e.next=21;break}return h=new FormData,e.next=16,i.arrayBuffer();case 16:return g=e.sent,v=new Blob([g]),h.append("file",v,t),e.next=21,u()({method:"POST",url:"upload",data:h,headers:{"Content-Type":"multipart/form-data"}});case 21:if(201===m.statusCode){e.next=23;break}return e.abrupt("return",!1);case 23:return e.abrupt("return",!0);case 26:return e.prev=26,e.t0=e.catch(7),console.error(e.t0),e.abrupt("return",!1);case 30:case"end":return e.stop()}}),e,null,[[7,26]])})))).apply(this,arguments)}u().defaults.baseURL=g;var w=p().createInstance({name:"updateHash"});function C(e){return T.apply(this,arguments)}function T(){return(T=(0,c.Z)((0,s.Z)().mark((function e(t){var n,r,a,c,i,d,p,x,h,g,v;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.U9)(t);case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return r=n.uid,a=n.name,c=n.withImg,i=n.pageOrder,d=n.pageRec,(0,o.Yl)(d),p={uid:r,name:a,withImg:c,pageOrder:i},x=m()(JSON.stringify([d,p])),e.next=11,w.getItem(t);case 11:if(h=e.sent,x!==h){e.next=14;break}return e.abrupt("return",!0);case 14:return e.prev=14,g={userID:(0,f.VN)(),pageRec:d,noteInfo:p},e.next=18,u().put("update/".concat(t),g);case 18:if(v=e.sent,201===v.data.statusCode){e.next=22;break}return e.abrupt("return",!1);case 22:return e.next=24,w.setItem(t,x);case 24:return e.abrupt("return",!0);case 27:return e.prev=27,e.t0=e.catch(14),console.error(e.t0),e.abrupt("return",!1);case 31:case"end":return e.stop()}}),e,null,[[14,27]])})))).apply(this,arguments)}var I=p().createInstance({name:"teamState"});function E(e,t){return D.apply(this,arguments)}function D(){return(D=(0,c.Z)((0,s.Z)().mark((function e(t,n){var r,a,c,i,o,l,d;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(t);case 2:return r=e.sent,a=r&&m()(JSON.stringify(r)),e.prev=4,e.next=7,u().get("state/".concat(t),{params:{userID:(0,f.VN)(),hash:a},onDownloadProgress:function(e){var t=e.loaded;null===n||void 0===n||n(t)}});case 7:if(c=e.sent,i=c.data,o=i.statusCode,l=i.modified,d=i.teamPages,200!==o||!l){e.next=14;break}return e.next=13,I.setItem(t,d);case 13:return e.abrupt("return",d);case 14:return e.abrupt("return",r);case 17:return e.prev=17,e.t0=e.catch(4),console.error(e.t0),e.abrupt("return",r);case 21:case"end":return e.stop()}}),e,null,[[4,17]])})))).apply(this,arguments)}function F(e){return A.apply(this,arguments)}function A(){return(A=(0,c.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getItem(t);case 2:if(e.t1=n=e.sent,e.t0=null!==e.t1,!e.t0){e.next=6;break}e.t0=void 0!==n;case 6:if(!e.t0){e.next=10;break}e.t2=n,e.next=11;break;case 10:e.t2=void 0;case 11:return e.abrupt("return",e.t2);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},72058:function(e,t,n){n.d(t,{eG:function(){return d},mp:function(){return o},pW:function(){return l}});var r=n(37762),a=n(74165),s=n(93433),c=n(15861),i=n(61842),u=n.n(i)().createInstance({name:"imageForage"}),o=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,n){var r,c,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.getItem("LIST");case 2:if(e.t1=r=e.sent,e.t0=null!==e.t1,!e.t0){e.next=6;break}e.t0=void 0!==r;case 6:if(!e.t0){e.next=10;break}e.t2=r,e.next=11;break;case 10:e.t2=[];case 11:if(c=e.t2,i="".concat(t,"_").concat(n),c.includes(i)){e.next=15;break}return e.abrupt("return");case 15:return c=[i].concat((0,s.Z)(c.filter((function(e){return e!==i})))),e.next=18,u.setItem("LIST",c);case 18:return e.next=20,u.getItem(i);case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),l=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,n,r){var c,i,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.getItem("LIST");case 2:if(e.t1=c=e.sent,e.t0=null!==e.t1,!e.t0){e.next=6;break}e.t0=void 0!==c;case 6:if(!e.t0){e.next=10;break}e.t2=c,e.next=11;break;case 10:e.t2=[];case 11:return i=e.t2,o="".concat(t,"_").concat(n),(i=[o].concat((0,s.Z)(i.filter((function(e){return e!==o}))))).length>10&&(i=i.slice(0,10)),e.next=17,u.setItem("LIST",i);case 17:return e.next=19,u.setItem(o,r);case 19:f();case 20:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),f=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){var t,n,s,c,i,o,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.getItem("LIST");case 2:if(e.t1=t=e.sent,e.t0=null!==e.t1,!e.t0){e.next=6;break}e.t0=void 0!==t;case 6:if(!e.t0){e.next=10;break}e.t2=t,e.next=11;break;case 10:e.t2=[];case 11:return n=e.t2,s=new Set(n),e.next=15,u.keys();case 15:c=e.sent,i=(0,r.Z)(c),e.prev=17,i.s();case 19:if((o=i.n()).done){e.next=28;break}if("LIST"!==(l=o.value)){e.next=23;break}return e.abrupt("continue",26);case 23:if(s.has(l)){e.next=26;break}return e.next=26,u.removeItem(l);case 26:e.next=19;break;case 28:e.next=33;break;case 30:e.prev=30,e.t3=e.catch(17),i.e(e.t3);case 33:return e.prev=33,i.f(),e.finish(33);case 36:case"end":return e.stop()}}),e,null,[[17,30,33,36]])})));return function(){return e.apply(this,arguments)}}(),d=function(){return u.clear()}},69951:function(e,t,n){n.d(t,{VN:function(){return a},lu:function(){return c},vW:function(){return s}});var r=n(49030),a=function(){var e;return function(){if(e)return e;var t=localStorage.getItem("USER_ID");return t||(t=(0,r.Z)(),localStorage.setItem("USER_ID",t)),e=t,t}}(),s=function(){var e=localStorage.getItem("USER_NAME");return e||(e=(0,r.Z)().slice(0,8),localStorage.setItem("USER_NAME",e)),e},c=function(e){return!!(e=e.trim())&&(localStorage.setItem("USER_NAME",e),!0)}},37991:function(e,t,n){n.r(t),n.d(t,{default:function(){return We}});var r=n(1413),a=n(29439),s=n(72791),c=n(75783),i=n(52365),u=n(74165),o=n(15861),l=n(92414),f=n(82622),d=n(93309),p=n(96324),x=n(79286),m=n(70776),h=n(92560),g=n(87309),v=n(34571),Z=n(74115),j=n(45987),k=n(13892),b=n(81694),y=n.n(b),N=n(49030),S=n(80184),w=["children","onDelete","disable","className"],C=(0,s.createContext)(["",function(){}]),T=function(e){var t=e.children,n=(0,s.useState)("");return(0,S.jsx)(C.Provider,{value:n,children:t})},I=function(e){var t=e.children,n=e.onDelete,c=e.disable,l=void 0!==c&&c,f=e.className,d=(0,j.Z)(e,w),p=(0,s.useState)(N.Z),x=(0,a.Z)(p,1)[0],m=(0,s.useContext)(C),h=(0,a.Z)(m,2),g=h[0],v=h[1],Z=(0,s.useState)(!1),b=(0,a.Z)(Z,2),T=b[0],I=b[1],E=T&&(!g||g===x),D=(0,s.useState)(!1),F=(0,a.Z)(D,2),A=F[0],P=F[1],O=(0,s.useState)(),M=(0,a.Z)(O,2),L=M[0],R=M[1],U=(0,s.useRef)(null);(0,s.useEffect)((function(){g!==x&&I(!1)}),[g,x]);var B=(0,k.QS)({onSwipedLeft:function(){var e;I(!0),v(x),R(null===(e=U.current)||void 0===e?void 0:e.clientHeight)},onSwipedRight:function(){I(!1),v(""),R(void 0)},preventScrollOnSwipe:!0,trackTouch:!l});(0,s.useEffect)((function(){l&&(R(void 0),v(""),I(!1))}),[l,v]);var V=(0,i.mf)({propertyName:"height",active:A}),W=(0,a.Z)(V,2),_=W[0],z=W[1],H=function(){var e=(0,o.Z)((0,u.Z)().mark((function e(){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),e.next=3,_;case 3:n(),v("");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,S.jsxs)("div",(0,r.Z)((0,r.Z)((0,r.Z)({className:y()("swipe-wrapper",f),"data-deleted":A,"data-deleting":E},B),{},{style:{height:L},onTransitionEnd:z},d),{},{children:[(0,S.jsx)("div",{className:"content",ref:U,children:t}),(0,S.jsx)("div",{className:"button",onClick:H,style:{height:L},children:"Delete"})]}))},E=n(35873),D=function(e){var t=e.tagName,n=e.setTagName,r=e.tagColor,a=e.setTagColor,s=(0,S.jsx)(m.Z,{value:r,onSelect:a,listHeight:150,virtual:!1,dropdownClassName:"tag-color-drop",children:Z.O9.map((function(e){return(0,S.jsx)(m.Z.Option,{value:e,children:(0,S.jsx)(E.W,{className:"tag-circle",color:e})},e)}))});return(0,S.jsx)(h.Z,{placeholder:"Tag name...",className:"tag-name-input",addonBefore:s,value:t,onChange:function(e){return n(e.target.value)}})},F=function(e){var t=e.noteTag,n=e.currTagID,i=e.setAllTags,d=e.setCurrTagID,p=t.uid,x=t.color,m=t.name,h=t.notes,j=(0,s.useState)(m),k=(0,a.Z)(j,2),b=k[0],y=k[1],N=(0,s.useState)(x),w=(0,a.Z)(N,2),C=w[0],T=w[1],F=(0,s.useState)(!1),A=(0,a.Z)(F,2),P=A[0],O=A[1],M=n===p;function L(){return R.apply(this,arguments)}function R(){return(R=(0,o.Z)((0,u.Z)().mark((function e(){var t;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.Pn)(p);case 2:t=e.sent,d("DEFAULT"),i(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,s.useEffect)((function(){return O(!1)}),[M]);var U=function(){var e=(0,o.Z)((0,u.Z)().mark((function e(){var n,a;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,r.Z)((0,r.Z)({},t),{},{name:b,color:C}),e.next=3,(0,c.tk)(n);case 3:a=e.sent,i(a),O(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(E.W,{className:"tag-circle",color:C}),(0,S.jsx)("span",{className:"tag-name",children:b}),M?(0,S.jsx)(g.Z,{size:"small",type:"text",onClick:function(){return O(!0)},icon:(0,S.jsx)(l.Z,{})}):(0,S.jsx)("span",{className:"tag-num",children:h.length})]}),V=(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(D,{tagName:b,setTagName:y,tagColor:C,setTagColor:T}),(0,S.jsxs)("div",{className:"buttons",children:[(0,S.jsx)(v.Z,{title:"This tag will be deleted.",onConfirm:L,placement:"left",cancelText:"Cancel",icon:(0,S.jsx)(f.Z,{}),okText:"Delete",okType:"danger",okButtonProps:{type:"primary"},children:(0,S.jsx)(g.Z,{danger:!0,children:"Delete"})}),(0,S.jsx)(g.Z,{onClick:function(){y(m),T(x),O(!1)},children:"Cancel"}),(0,S.jsx)(g.Z,{type:"primary",disabled:!b,onClick:U,children:"OK"})]})]});return(0,S.jsx)(I,{className:"tag-wrapper",onDelete:L,disable:P,children:(0,S.jsx)("div",{className:"tag-item","data-curr":M,"data-editing":P,onClick:function(){return d(p)},style:(0,Z.MW)(x),children:P?V:B})})},A=function(e){var t=e.setAdding,n=e.setAllTags,r=(0,s.useState)(""),i=(0,a.Z)(r,2),u=i[0],o=i[1],l=(0,s.useState)((0,Z.mr)()),f=(0,a.Z)(l,2),d=f[0],p=f[1];return(0,S.jsx)("div",{className:"tag-wrapper",children:(0,S.jsxs)("div",{className:"tag-item","data-editing":!0,children:[(0,S.jsx)(D,{tagName:u,setTagName:o,tagColor:d,setTagColor:p}),(0,S.jsxs)("div",{className:"buttons",children:[(0,S.jsx)(g.Z,{onClick:function(){return t(!1)},children:"Cancel"}),(0,S.jsx)(g.Z,{type:"primary",disabled:!u,onClick:function(){var e=u.trim();e&&((0,c.HO)(e,d).then(n),t(!1))},children:"OK"})]})]})})},P=function(e){var t=e.allTags,n=e.currTagID,c=e.allNotes,u=e.setCurrTagID,o=(0,s.useState)(!1),l=(0,a.Z)(o,2),f=l[0],m=l[1],h=(0,i.LH)(),v=(0,a.Z)(h,2),Z=v[0],j=v[1],k=(0,S.jsx)("div",{className:"tag-wrapper",children:(0,S.jsxs)("div",{className:"tag-item","data-curr":"DEFAULT"===n,onClick:function(){return u("DEFAULT")},children:[(0,S.jsx)(d.Z,{className:"all-note-icon"}),(0,S.jsx)("span",{className:"tag-name",children:"All Notes"}),(0,S.jsx)("span",{className:"tag-num",children:Object.keys(c).length})]})}),b=(0,S.jsxs)("header",{children:[(0,S.jsx)(g.Z,{className:"aside-btn",type:"text",icon:(0,S.jsx)(p.Z,{}),onClick:function(){return j(!1)}}),(0,S.jsx)("h2",{className:"logo",children:"Multibility"}),(0,S.jsx)(g.Z,{className:"new-tag-btn",type:"text",icon:(0,S.jsx)(x.Z,{}),onClick:function(){return m(!0)},disabled:f})]});return(0,S.jsx)("aside",{"data-open":Z,onClick:function(){return j(!1)},children:(0,S.jsxs)("div",{className:"side-menu",onClick:function(e){return e.stopPropagation()},children:[b,(0,S.jsxs)("div",{className:"tag-list",children:[k,(0,S.jsx)(T,{children:Object.values(t).map((function(t){return(0,S.jsx)(F,(0,r.Z)({noteTag:t},e),t.uid)}))}),f&&(0,S.jsx)(A,(0,r.Z)({setAdding:m},e))]})]})})},O=n(4942),M=n(75660),L=n(56983),R=n(96989),U=n(37557),B=n(57293),V=n(57689),W=n(24124),_=n(51570),z=n(79856),H=n(69228),G=n(30501),K=n(56200),Y=n(92198),J=n(78502),Q=n(50419),X=n(28817),$=n(36090),q=n(99372),ee=n(66776),te=n(29529),ne=n(12056),re=n(99660),ae=n(61753),se=n(69951),ce=n(72058),ie=n(61842),ue=n.n(ie),oe=["children","title","keyName"],le=function(e){var t=e.children,n=e.title,s=e.keyName,c=(0,j.Z)(e,oe),u=(0,i.zI)(),o=(0,a.Z)(u,2),l=o[0],f=o[1];return(0,S.jsx)(L.Z,(0,r.Z)((0,r.Z)({in:l===s},c),{},{children:(0,S.jsx)("div",{className:"secondary",children:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("nav",{children:[(0,S.jsx)(g.Z,{type:"text",shape:"circle",onClick:function(){return f("MENU")},icon:(0,S.jsx)(q.Z,{})}),(0,S.jsx)("h3",{children:n})]}),t]})})}))},fe=function(e){var t=e.currTagID,r=e.setAllTags,i=e.setAllNotes,l=(0,s.useState)(!1),f=(0,a.Z)(l,2),d=f[0],p=f[1],x=(0,s.useState)(0),m=(0,a.Z)(x,2),h=m[0],g=m[1];function v(){return(v=(0,o.Z)((0,u.Z)().mark((function e(a){var s,o,l,f,d,x;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("application/pdf"===a.type){e.next=2;break}return e.abrupt("return");case 2:return p(!0),e.next=5,Promise.all([n.e(574),n.e(643),n.e(61)]).then(n.bind(n,21176));case 5:return s=e.sent,o=s.LoadPDF,e.next=9,o(a,g);case 9:return(l=e.sent).tagID=t,e.next=13,(0,c.au)(l);case 13:return f=e.sent,d=f.tags,x=f.allNotes,r(d),i(x),p(!1),Q.ZP.success("PDF Loaded"),e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,S.jsxs)("label",{children:[(0,S.jsxs)("div",{className:"pdf-upload",children:[(0,S.jsx)("div",{className:"icon-wrapper",children:d?(0,S.jsx)(X.Z,{width:48,type:"circle",percent:h}):(0,S.jsx)(ee.Z,{className:"inbox-icon"})}),(0,S.jsx)("p",{className:"hint",children:"Click to import a pdf file."})]}),(0,S.jsx)("input",{type:"file",multiple:!1,accept:".pdf",onChange:function(e){var t=e.target.files,n=t&&t[0];n&&function(e){v.apply(this,arguments)}(n)}})]})},de=function(){var e=(0,i.zI)(),t=(0,a.Z)(e,2)[1],n=(0,se.vW)(),r=(0,s.useState)(n),c=(0,a.Z)(r,2),u=c[0],o=c[1];return(0,S.jsxs)("div",{className:"profile-page",children:[(0,S.jsx)(h.Z,{value:u,onChange:function(e){return o(e.target.value)},prefix:(0,S.jsx)(te.Z,{}),allowClear:!0}),(0,S.jsx)(g.Z,{disabled:n===u||!u,onClick:function(){u&&((0,se.lu)(u),t("MENU"))},type:"primary",block:!0,children:"OK"})]})},pe=function(){var e=function(){var e=(0,o.Z)((0,u.Z)().mark((function e(){return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue().clear();case 2:return e.next=4,(0,ce.eG)();case 4:localStorage.clear(),window.location.reload();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,S.jsx)("div",{className:"setting-menu",children:(0,S.jsx)(v.Z,{title:"Everything will be deleted.",onConfirm:e,icon:(0,S.jsx)(ne.Z,{}),okText:"Delete",okType:"danger",okButtonProps:{type:"primary"},cancelText:"Cancel",placement:"bottom",children:(0,S.jsx)(g.Z,{icon:(0,S.jsx)(ne.Z,{}),danger:!0,block:!0,children:"Clear all"})})})},xe=[{key:"PDF",label:"Import PDF",icon:(0,S.jsx)(re.Z,{})},{key:"PROFILE",label:"My profile",icon:(0,S.jsx)(te.Z,{})},{key:"SETTINGS",label:"Settings",icon:(0,S.jsx)(l.Z,{})}],me=function(){var e=(0,i.zI)(),t=(0,a.Z)(e,2)[1];return(0,S.jsx)("div",{className:"primary-menu",children:(0,S.jsx)($.Z,{onClick:function(e){var n=e.key;return t(n)},items:xe})})},he=function(e){var t=(0,s.useState)(0),n=(0,a.Z)(t,2),c=n[0],u=n[1],o=(0,i.zI)(),l=(0,a.Z)(o,2),f=l[0],d=l[1],p={timeout:300,onEnter:function(e){u(e.clientHeight)},unmountOnExit:!0};(0,s.useEffect)((function(){return d("MENU")}),[d]);var x={PDF:(0,S.jsx)(fe,(0,r.Z)({},e)),PROFILE:(0,S.jsx)(de,{}),SETTINGS:(0,S.jsx)(pe,{})};return(0,S.jsxs)("section",{className:"others-menu",style:{height:c},children:[(0,S.jsx)(L.Z,(0,r.Z)((0,r.Z)({in:"MENU"===f},p),{},{children:(0,S.jsx)(me,{})})),xe.map((function(e){var t=e.key,n=e.label;return(0,S.jsx)(le,(0,r.Z)((0,r.Z)({keyName:t,title:n},p),{},{children:x[t]}),t)}))]})},ge=function(e){return(0,S.jsxs)(H.Z,{placement:"bottomRight",trigger:"click",content:(0,S.jsx)(i.s2,{initKey:"",children:(0,S.jsx)(he,(0,r.Z)({},e))}),zIndex:900,children:[(0,S.jsx)(g.Z,{className:"small",type:"text",icon:(0,S.jsx)(ae.Z,{})}),(0,S.jsx)(g.Z,{className:"large",shape:"circle",icon:(0,S.jsx)(ae.Z,{})})]})},ve=function(e){return(0,S.jsxs)("nav",{children:[(0,S.jsx)(Ze,(0,r.Z)({},e)),(0,S.jsx)(je,(0,r.Z)({},e))]})},Ze=function(e){var t,n,r=e.allTags,s=e.currTagID,c=(0,i.LH)(),u=(0,a.Z)(c,2)[1],o=null!==(t=null===(n=r[s])||void 0===n?void 0:n.name)&&void 0!==t?t:"All notes";return(0,S.jsxs)("div",{className:"nav-left",children:[(0,S.jsx)(g.Z,{className:"aside-btn small",type:"text",icon:(0,S.jsx)(p.Z,{}),onClick:function(){return u(!0)}}),(0,S.jsx)("h2",{children:(0,S.jsx)("b",{children:o})})]})},je=function(e){return(0,S.jsxs)("div",{className:"nav-right",children:[(0,S.jsx)(ke,(0,r.Z)({},e)),(0,S.jsx)(be,{}),(0,S.jsx)(ge,(0,r.Z)({},e))]})},ke=function(e){var t=e.currTagID,n=e.setAllTags,r=e.setAllNotes;function a(){return s.apply(this,arguments)}function s(){return(s=(0,o.Z)((0,u.Z)().mark((function e(){var a,s,i,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=(0,Y.Xn)()).tagID=t,e.next=4,(0,c.au)(a);case 4:s=e.sent,i=s.tags,o=s.allNotes,n(i),r(o);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(g.Z,{className:"new-note large",type:"primary",shape:"round",onClick:a,icon:(0,S.jsx)(G.Z,{}),children:"New"}),(0,S.jsx)(g.Z,{className:"new-note small",type:"link",onClick:a,icon:(0,S.jsx)(G.Z,{})})]})},be=function(){var e=(0,s.useState)(""),t=(0,a.Z)(e,2),n=t[0],r=t[1],c=(0,s.useState)(!1),i=(0,a.Z)(c,2),l=i[0],f=i[1],d=(0,V.s0)();function p(){return(p=(0,o.Z)((0,u.Z)().mark((function e(t){var n;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,_.fI)(t);case 2:if(!(n=e.sent)){e.next=5;break}return e.abrupt("return",d("/team/".concat(n)));case 5:r(""),f(!0);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,S.jsxs)(H.Z,{placement:"bottomRight",trigger:"click",title:"Join a team note",destroyTooltipOnHide:!0,onOpenChange:function(){return f(!1)},content:(0,S.jsx)(J.GD,{plain:!0,length:4,error:l,value:n,onChange:function(e){f(!1),r(e)},onFill:function(e){return p.apply(this,arguments)}}),children:[(0,S.jsx)(g.Z,{className:"team-btn large",shape:"round",icon:(0,S.jsx)(K.Z,{}),children:"Team"}),(0,S.jsx)(g.Z,{className:"team-btn small",type:"text",icon:(0,S.jsx)(K.Z,{})})]})},ye=n(93433),Ne=n(37762),Se=n(60481),we=n(68692),Ce=n(13876),Te=n(20054),Ie=n(9486),Ee=n(1194),De=n(74270),Fe=n(11730),Ae=function(e){var t=e.sortType,n=e.setSortType,a=e.editing,s=e.setEditing,i=e.searchText,l=e.setSearchText,d=e.selectedNotes,p=e.setAllNotes,x=e.setAllTags,m=e.allTags,Z={items:[{type:"group",children:[{icon:(0,S.jsx)(we.Z,{}),key:"CREATE",label:"Date created"},{icon:(0,S.jsx)(Ce.Z,{}),key:"LAST",label:"Date modified"},{icon:(0,S.jsx)(Te.Z,{}),key:"NAME",label:"Name"}],label:"Sort by",className:"sort-drop"}],onClick:function(e){var t=e.key;n(t)},selectedKeys:[t]},j={type:"text",shape:"circle"},k=(0,S.jsx)(Se.Z,{menu:Z,trigger:["click"],placement:"bottomRight",children:(0,S.jsx)(g.Z,(0,r.Z)({className:"sort-btn",icon:(0,S.jsx)(Ie.Z,{rotate:90})},j))}),b=0===d.size,y=function(){var e=(0,o.Z)((0,u.Z)().mark((function e(){var t,n,r,a,s,i;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(0,Ne.Z)(d.toArray()),e.prev=1,r.s();case 3:if((a=r.n()).done){e.next=12;break}return s=a.value,e.next=7,(0,c.f_)(s);case 7:i=e.sent,t=i.tags,n=i.allNotes;case 10:e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:t&&x(t),n&&p(n);case 22:case"end":return e.stop()}}),e,null,[[1,14,17,20]])})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=(0,o.Z)((0,u.Z)().mark((function e(t){var n,r,a,s,i,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=(0,Ne.Z)(d.toArray()),e.prev=1,a.s();case 3:if((s=a.n()).done){e.next=12;break}return i=s.value,e.next=7,(0,c.tw)(i,t);case 7:o=e.sent,n=o.tags,r=o.allNotes;case 10:e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),a.e(e.t0);case 17:return e.prev=17,a.f(),e.finish(17);case 20:n&&x(n),r&&p(r);case 22:case"end":return e.stop()}}),e,null,[[1,14,17,20]])})));return function(t){return e.apply(this,arguments)}}(),w=(0,S.jsx)(v.Z,{title:"Notes will be deleted.",onConfirm:y,icon:(0,S.jsx)(f.Z,{}),placement:"bottom",cancelText:"Cancel",disabled:b,okText:"Delete",okType:"danger",okButtonProps:{type:"primary"},children:(0,S.jsx)(g.Z,{className:"del-btn",shape:"round",type:"text",disabled:b,danger:!b,icon:(0,S.jsx)(f.Z,{}),children:"Delete"})}),C=function(e){var t=e.color,n=e.name;return(0,S.jsxs)("div",{className:"tag-select",children:[(0,S.jsx)(E.W,{color:t,className:"tag-circle"}),(0,S.jsx)("span",{className:"name",children:n})]})},T=(0,S.jsx)($.Z,{onClick:function(e){var t=e.key;return N(t)},items:[{key:"DEFAULT",label:(0,S.jsx)(C,{color:"#eee",name:"No tag"})}].concat((0,ye.Z)(Object.values(m).map((function(e){return{key:e.uid,label:(0,S.jsx)(C,{color:e.color,name:e.name})}}))))}),I=(0,S.jsx)(Se.Z,{overlayClassName:"tag-drop",disabled:b,overlay:T,trigger:["click"],placement:"bottom",children:(0,S.jsx)(g.Z,{shape:"round",type:"text",className:"tag-btn",icon:(0,S.jsx)(Ee.Z,{}),style:{transition:"none"},children:"Tag"})});return(0,S.jsx)("div",{className:"list-tools","data-editing":a,children:a?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(g.Z,(0,r.Z)({onClick:function(){return s(!1)},icon:(0,S.jsx)(q.Z,{})},j)),I,w]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(g.Z,(0,r.Z)({onClick:function(){return s(!0)},icon:(0,S.jsx)(De.Z,{})},j)),(0,S.jsx)(h.Z,{value:i,onChange:function(e){return l(e.target.value)},className:"search-input",prefix:(0,S.jsx)(Fe.Z,{}),bordered:!1,allowClear:!0}),k]})})},Pe=n(97892),Oe=n.n(Pe),Me=n(6593),Le=n.n(Me);Oe().extend(Le());var Re=function(e){var t=(0,s.useState)(!1),n=(0,a.Z)(t,2),i=n[0],l=n[1],f=(0,s.useState)("LAST"),d=(0,a.Z)(f,2),p=d[0],x=d[1],m=(0,s.useState)(""),h=(0,a.Z)(m,2),g=h[0],v=h[1],Z=(0,s.useState)((0,W.l4)()),j=(0,a.Z)(Z,2),k=j[0],b=j[1],y=e.setAllTags,N=e.setAllNotes,w=function(){var e=(0,o.Z)((0,u.Z)().mark((function e(t){var n,r,a;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.f_)(t);case 2:n=e.sent,r=n.tags,a=n.allNotes,N(a),y(r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=e.currTagID,E=e.allNotes,D=e.allTags,F=(0,s.useMemo)((function(){var e,t;return(0,W.aV)((null!==(e=null===(t=D[C])||void 0===t?void 0:t.notes)&&void 0!==e?e:Object.keys(E)).map((function(e){return E[e]})).filter((function(e){return void 0!==e})))}),[E,D,C]),A=(0,s.useMemo)((function(){var e=function(e,t){return t-e};switch(p){case"CREATE":return F.sortBy((function(e){return e.createTime}),e);case"LAST":return F.sortBy((function(e){return e.lastTime}),e);case"NAME":return F.sortBy((function(e){return e.name.toUpperCase()}));default:return F}}),[F,p]),P=(0,s.useMemo)((function(){return A.filter((function(e){return e.name.toUpperCase().includes(g.trim().toUpperCase())}))}),[g,A]);return(0,s.useEffect)((function(){v(""),b((0,W.l4)())}),[F,i]),(0,S.jsxs)("div",{className:"note-list",children:[(0,S.jsxs)("header",{children:[(0,S.jsx)(ve,(0,r.Z)({},e)),(0,S.jsx)(Ae,(0,r.Z)({sortType:p,setSortType:x,editing:i,setEditing:l,searchText:g,setSearchText:v,selectedNotes:k},e))]}),(0,S.jsx)(T,{children:(0,S.jsx)(M.Z,{component:null,children:P.map((function(t,n){var a,s=t.uid,c=k.has(s),u=null===(a=P.get(n+1))||void 0===a?void 0:a.uid,o=(u&&k.has(u))!==c;return(0,S.jsx)(L.Z,{timeout:300,children:function(n){return(0,S.jsx)(I,{className:"note-wrapper",onDelete:function(){return w(s)},disable:i,"data-last":o,"data-selected":c,children:(0,S.jsx)(Ue,(0,r.Z)({timgShow:/^(entered|exiting)$/.test(n),noteInfo:t,selected:c,editing:i,setSelectNotes:b},e))})}},s)}))})})]})},Ue=function(e){var t=e.noteInfo,n=e.selected,i=e.editing,u=e.setSelectNotes,o=e.setAllNotes,l=e.allTags,f=e.currTagID,d=e.timgShow,p=t.team,x=t.uid,m=t.name,g=t.lastTime,v=t.tagID,j=(0,s.useMemo)((function(){return Oe()(g).calendar()}),[g]),k="".concat(p?"team":"reader","/").concat(x),b=(0,s.useState)(m),y=(0,a.Z)(b,2),N=y[0],w=y[1],C=(0,V.s0)(),T=l[v];return(0,S.jsxs)("div",{className:"note-item","data-selected":n,onClick:function(){if(!i)return C(k);u((function(e){return e.has(x)?e.delete(x):e.add(x)}))},children:[(0,S.jsxs)("div",{className:"left",children:[d&&(0,S.jsx)(Ve,{uid:x}),p&&(0,S.jsx)(R.Z,{className:"cloud-icon"}),(0,S.jsx)(U.Z,{className:"checked-icon"})]}),(0,S.jsxs)("div",{className:"content",children:[i&&!n?(0,S.jsx)(h.Z,{className:"name-input",value:N,onChange:function(e){return w(e.target.value)},onClick:function(e){return e.stopPropagation()},onBlur:function(){var e=N.trim();if(!e||e===m)return w(m);(0,c.SP)(x,{name:e}),o((function(n){return(0,r.Z)((0,r.Z)({},n),{},(0,O.Z)({},x,(0,r.Z)((0,r.Z)({},t),{},{name:e})))}))}}):(0,S.jsx)("p",{className:"name",children:m}),(0,S.jsxs)("p",{className:"info",children:[(0,S.jsx)("span",{className:"date",children:j}),T&&"DEFAULT"===f&&(0,S.jsx)("span",{className:"tag",style:(0,Z.MW)(T.color),children:T.name})]})]})]})},Be=s.lazy((function(){return Promise.all([n.e(814),n.e(28),n.e(560)]).then(n.bind(n,241))})),Ve=function(e){var t,n=e.uid,r=(0,s.useState)(),i=(0,a.Z)(r,2),u=i[0],o=i[1],l=(0,s.useState)(),f=(0,a.Z)(l,2),d=f[0],p=f[1];(0,s.useEffect)((function(){(0,c.U9)(n).then(o),(0,_.ox)(n).then(p)}),[n]);var x=null!==(t=null===u||void 0===u?void 0:u.pageOrder[0])&&void 0!==t?t:"",m=null===u||void 0===u?void 0:u.pageRec[x],h=(0,s.useMemo)((function(){if(m){var e=m.state,t=m.ratio;return B.Dw.loadFromFlat(e,t)}}),[m]),g=(0,s.useMemo)((function(){if(d&&x)return z.f.createFromTeamPages(d).getOnePageStateMap(x)}),[d,x]);if(!m||!h)return null;var v=m.ratio,Z=m.image;return(0,S.jsx)("div",{className:"timg-wrapper","data-landscape":v<1,children:(0,S.jsx)(s.Suspense,{fallback:null,children:(0,S.jsx)(Be,{drawState:h,teamStateMap:g,thumbnail:Z,preview:!0})})})};function We(){var e=(0,s.useState)({}),t=(0,a.Z)(e,2),n=t[0],u=t[1],o=(0,s.useState)({}),l=(0,a.Z)(o,2),f=l[0],d=l[1],p=(0,s.useState)("DEFAULT"),x=(0,a.Z)(p,2),m=x[0],h=x[1];(0,s.useEffect)((function(){(0,c.hY)().then(u),(0,c.Ys)().then(d),document.title="Multibility"}),[]);var g={allNotes:n,allTags:f,setAllNotes:u,setAllTags:d,currTagID:m,setCurrTagID:h};return(0,S.jsx)("div",{className:"main-menu container",children:(0,S.jsxs)(i.kV,{children:[(0,S.jsx)(P,(0,r.Z)({},g)),(0,S.jsx)(Re,(0,r.Z)({},g))]})})}}}]);
//# sourceMappingURL=426.b0f7a2b5.chunk.js.map