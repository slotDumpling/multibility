"use strict";(self.webpackChunkmultibility=self.webpackChunkmultibility||[]).push([[137],{72058:function(e,t,n){n.d(t,{eG:function(){return x},mp:function(){return o},pW:function(){return u}});var r=n(37762),a=n(74165),s=n(93433),c=n(15861),i=n(61842),l=n.n(i)().createInstance({name:"imageForage"}),o=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,n){var r,c,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getItem("LIST");case 2:if(e.t1=r=e.sent,e.t0=null!==e.t1,!e.t0){e.next=6;break}e.t0=void 0!==r;case 6:if(!e.t0){e.next=10;break}e.t2=r,e.next=11;break;case 10:e.t2=[];case 11:if(c=e.t2,i="".concat(t,"_").concat(n),c.includes(i)){e.next=15;break}return e.abrupt("return");case 15:return c=[i].concat((0,s.Z)(c.filter((function(e){return e!==i})))),e.next=18,l.setItem("LIST",c);case 18:return e.next=20,l.getItem(i);case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,n,r){var c,i,o;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getItem("LIST");case 2:if(e.t1=c=e.sent,e.t0=null!==e.t1,!e.t0){e.next=6;break}e.t0=void 0!==c;case 6:if(!e.t0){e.next=10;break}e.t2=c,e.next=11;break;case 10:e.t2=[];case 11:return i=e.t2,o="".concat(t,"_").concat(n),(i=[o].concat((0,s.Z)(i.filter((function(e){return e!==o}))))).length>10&&(i=i.slice(0,10)),e.next=17,l.setItem("LIST",i);case 17:return e.next=19,l.setItem(o,r);case 19:d();case 20:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),d=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(){var t,n,s,c,i,o,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getItem("LIST");case 2:if(e.t1=t=e.sent,e.t0=null!==e.t1,!e.t0){e.next=6;break}e.t0=void 0!==t;case 6:if(!e.t0){e.next=10;break}e.t2=t,e.next=11;break;case 10:e.t2=[];case 11:return n=e.t2,s=new Set(n),e.next=15,l.keys();case 15:c=e.sent,i=(0,r.Z)(c),e.prev=17,i.s();case 19:if((o=i.n()).done){e.next=28;break}if("LIST"!==(u=o.value)){e.next=23;break}return e.abrupt("continue",26);case 23:if(s.has(u)){e.next=26;break}return e.next=26,l.removeItem(u);case 26:e.next=19;break;case 28:e.next=33;break;case 30:e.prev=30,e.t3=e.catch(17),i.e(e.t3);case 33:return e.prev=33,i.f(),e.finish(33);case 36:case"end":return e.stop()}}),e,null,[[17,30,33,36]])})));return function(){return e.apply(this,arguments)}}(),x=function(){return l.clear()}},41710:function(e,t,n){n.r(t),n.d(t,{default:function(){return Je}});var r=n(1413),a=n(29439),s=n(72791),c=n(75783),i=n(52365),l=n(74165),o=n(15861),u=n(92414),d=n(82622),x=n(93309),f=n(96324),p=n(79286),m=n(34204),h=n(70776),Z=n(92560),j=n(87309),v=n(34571),g=n(74115),N=n(45987),k=n(13892),y=n(81694),b=n.n(y),T=n(92810),S=n(80184),w=["children","onDelete","disable","className"],C=(0,s.createContext)(["",function(){}]),I=function(e){var t=e.children,n=(0,s.useState)("");return(0,S.jsx)(C.Provider,{value:n,children:t})},D=function(e){var t=e.children,n=e.onDelete,c=e.disable,u=void 0!==c&&c,d=e.className,x=(0,N.Z)(e,w),f=(0,s.useState)(T.Z),p=(0,a.Z)(f,1)[0],m=(0,s.useContext)(C),h=(0,a.Z)(m,2),Z=h[0],j=h[1],v=(0,s.useState)(!1),g=(0,a.Z)(v,2),y=g[0],I=g[1],D=y&&(!Z||Z===p),E=(0,s.useState)(!1),A=(0,a.Z)(E,2),F=A[0],L=A[1],O=(0,s.useState)(),M=(0,a.Z)(O,2),P=M[0],R=M[1],U=(0,s.useRef)(null);(0,s.useEffect)((function(){Z!==p&&I(!1)}),[Z,p]);var z=(0,k.QS)({onSwipedLeft:function(){var e;I(!0),j(p),R(null===(e=U.current)||void 0===e?void 0:e.clientHeight)},onSwipedRight:function(){I(!1),j(""),R(void 0)},preventScrollOnSwipe:!0,trackTouch:!u});(0,s.useEffect)((function(){u&&(R(void 0),j(""),I(!1))}),[u,j]);var B=(0,i.mf)({propertyName:"height",active:F}),H=(0,a.Z)(B,2),W=H[0],G=H[1],K=function(){var e=(0,o.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(!0),e.next=3,W;case 3:n(),j("");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,S.jsxs)("div",(0,r.Z)((0,r.Z)((0,r.Z)({className:b()("swipe-wrapper",d),"data-deleted":F,"data-deleting":D},z),{},{style:{height:P},onTransitionEnd:G},x),{},{children:[(0,S.jsx)("div",{className:"content",ref:U,children:t}),(0,S.jsx)("div",{className:"button",onClick:K,style:{height:P},children:"Delete"})]}))},E=n(35873),A=n(22568),F=function(e){var t=e.tagName,n=e.setTagName,r=e.tagColor,a=e.setTagColor,s=(0,S.jsx)(h.Z,{value:r,onSelect:a,listHeight:150,virtual:!1,dropdownClassName:"tag-color-drop",children:g.O9.map((function(e){return(0,S.jsx)(h.Z.Option,{value:e,children:(0,S.jsx)(E.W,{className:"tag-circle",color:e})},e)}))});return(0,S.jsx)(Z.Z,{placeholder:"Tag name...",className:"tag-name-input",addonBefore:s,value:t,onChange:function(e){return n(e.target.value)}})},L=function(e){var t=e.noteTag,n=e.currTagID,i=e.setAllTags,x=e.setCurrTagID,f=t.uid,p=t.color,m=t.name,h=t.notes,Z=(0,s.useState)(m),N=(0,a.Z)(Z,2),k=N[0],y=N[1],b=(0,s.useState)(p),T=(0,a.Z)(b,2),w=T[0],C=T[1],I=(0,s.useState)(!1),A=(0,a.Z)(I,2),L=A[0],O=A[1],M=n===f;function P(){return R.apply(this,arguments)}function R(){return(R=(0,o.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.Pn)(f);case 2:t=e.sent,x("DEFAULT"),i(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,s.useEffect)((function(){return O(!1)}),[M]);var U=function(){var e=(0,o.Z)((0,l.Z)().mark((function e(){var n,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,r.Z)((0,r.Z)({},t),{},{name:k,color:w}),e.next=3,(0,c.tk)(n);case 3:a=e.sent,i(a),O(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(E.W,{className:"tag-circle",color:w}),(0,S.jsx)("span",{className:"tag-name",children:k}),M?(0,S.jsx)(j.Z,{size:"small",type:"text",onClick:function(){return O(!0)},icon:(0,S.jsx)(u.Z,{})}):(0,S.jsx)("span",{className:"tag-num",children:h.length})]}),B=(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(F,{tagName:k,setTagName:y,tagColor:w,setTagColor:C}),(0,S.jsxs)("div",{className:"buttons",children:[(0,S.jsx)(v.Z,{title:"This tag will be deleted.",onConfirm:P,placement:"left",cancelText:"Cancel",icon:(0,S.jsx)(d.Z,{}),okText:"Delete",okType:"danger",okButtonProps:{type:"primary"},children:(0,S.jsx)(j.Z,{danger:!0,children:"Delete"})}),(0,S.jsx)(j.Z,{onClick:function(){y(m),C(p),O(!1)},children:"Cancel"}),(0,S.jsx)(j.Z,{type:"primary",disabled:!k,onClick:U,children:"OK"})]})]});return(0,S.jsx)(D,{className:"tag-wrapper",onDelete:P,disable:L,children:(0,S.jsx)("div",{className:"tag-item","data-curr":M,"data-editing":L,onClick:function(){return x(f)},style:(0,g.MW)(p),children:L?B:z})})},O=function(e){var t=e.setAdding,n=e.setAllTags,r=(0,s.useState)(""),i=(0,a.Z)(r,2),l=i[0],o=i[1],u=(0,s.useState)((0,g.mr)()),d=(0,a.Z)(u,2),x=d[0],f=d[1];return(0,S.jsx)("div",{className:"tag-wrapper",children:(0,S.jsxs)("div",{className:"tag-item","data-editing":!0,children:[(0,S.jsx)(F,{tagName:l,setTagName:o,tagColor:x,setTagColor:f}),(0,S.jsxs)("div",{className:"buttons",children:[(0,S.jsx)(j.Z,{onClick:function(){return t(!1)},children:"Cancel"}),(0,S.jsx)(j.Z,{type:"primary",disabled:!l,onClick:function(){var e=l.trim();e&&((0,c.HO)(e,x).then(n),t(!1))},children:"OK"})]})]})})},M=function(e){var t=e.allTags,n=e.currTagID,c=e.allNotes,l=e.setCurrTagID,o=(0,s.useState)(!1),u=(0,a.Z)(o,2),d=u[0],h=u[1],Z=(0,i.LH)(),v=(0,a.Z)(Z,2),g=v[0],N=v[1],k=(0,S.jsx)("div",{className:"tag-wrapper",children:(0,S.jsxs)("div",{className:"tag-item","data-curr":"DEFAULT"===n,onClick:function(){return l("DEFAULT")},children:[(0,S.jsx)(x.Z,{className:"all-note-icon"}),(0,S.jsx)("span",{className:"tag-name",children:"All Notes"}),(0,S.jsx)("span",{className:"tag-num",children:Object.keys(c).length})]})}),y=(0,S.jsxs)("header",{children:[(0,S.jsx)(j.Z,{className:"aside-btn",type:"text",icon:(0,S.jsx)(f.Z,{}),onClick:function(){return N(!1)}}),(0,S.jsx)("h2",{className:"logo",children:"Multibility"}),(0,S.jsx)(j.Z,{className:"new-tag-btn",type:"text",icon:(0,S.jsx)(p.Z,{}),onClick:function(){return h(!0)},disabled:d})]}),b=(0,S.jsxs)("footer",{children:[(0,S.jsx)(j.Z,{icon:(0,S.jsx)(m.Z,{}),href:"https://github.com/slotDumpling/multibility",shape:"round",size:"small",children:"GitHub"}),(0,S.jsx)(j.Z,{icon:(0,S.jsx)(A.Z,{type:"icon-npm"}),href:"https://www.npmjs.com/package/draft-pad",shape:"round",size:"small",children:"draft-pad"})]});return(0,S.jsx)("aside",{"data-open":g,onClick:function(){return N(!1)},children:(0,S.jsxs)("div",{className:"side-menu",onClick:function(e){return e.stopPropagation()},children:[y,(0,S.jsxs)("div",{className:"tag-list",children:[k,(0,S.jsx)(I,{children:Object.values(t).map((function(t){return(0,S.jsx)(L,(0,r.Z)({noteTag:t},e),t.uid)}))}),d&&(0,S.jsx)(O,(0,r.Z)({setAdding:h},e))]}),b]})})},P=n(4942),R=n(75660),U=n(56983),z=n(96989),B=n(37557),H=n(77106),W=n(91715),G=n(57689),K=n(24124),_=n(51570),J=n(79856),X=n(69228),Y=n(30501),Q=n(56200),V=n(92198),$=n(86383),q=n(50419),ee=n(28817),te=n(36090),ne=n(99372),re=n(66776),ae=n(29529),se=n(12056),ce=n(99660),ie=n(61753),le=n(69951),oe=n(72058),ue=n(61842),de=n.n(ue),xe=["children","title","keyName"],fe=function(e){var t=e.children,n=e.title,s=e.keyName,c=(0,N.Z)(e,xe),l=(0,i.zI)(),o=(0,a.Z)(l,2),u=o[0],d=o[1];return(0,S.jsx)(U.Z,(0,r.Z)((0,r.Z)({in:u===s},c),{},{children:(0,S.jsx)("div",{className:"secondary",children:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("nav",{children:[(0,S.jsx)(j.Z,{type:"text",shape:"circle",onClick:function(){return d("MENU")},icon:(0,S.jsx)(ne.Z,{})}),(0,S.jsx)("h3",{children:n})]}),t]})})}))},pe=function(e){var t=e.currTagID,r=e.setAllTags,i=e.setAllNotes,u=(0,s.useState)(!1),d=(0,a.Z)(u,2),x=d[0],f=d[1],p=(0,s.useState)(0),m=(0,a.Z)(p,2),h=m[0],Z=m[1];function j(){return(j=(0,o.Z)((0,l.Z)().mark((function e(a){var s,o,u,d,x,p;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("application/pdf"===a.type){e.next=2;break}return e.abrupt("return");case 2:return f(!0),e.next=5,Promise.all([n.e(643),n.e(176)]).then(n.bind(n,98338));case 5:return s=e.sent,o=s.LoadPDF,e.next=9,o(a,Z);case 9:return(u=e.sent).tagID=t,e.next=13,(0,c.au)(u);case 13:return d=e.sent,x=d.tags,p=d.allNotes,r(x),i(p),f(!1),q.ZP.success("PDF Loaded"),e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,S.jsxs)("label",{children:[(0,S.jsxs)("div",{className:"pdf-upload",children:[(0,S.jsx)("div",{className:"icon-wrapper",children:x?(0,S.jsx)(ee.Z,{width:48,type:"circle",percent:h}):(0,S.jsx)(re.Z,{className:"inbox-icon"})}),(0,S.jsx)("p",{className:"hint",children:"Click to import a pdf file."})]}),(0,S.jsx)("input",{type:"file",multiple:!1,accept:".pdf",onChange:function(e){var t=e.target.files,n=t&&t[0];n&&function(e){j.apply(this,arguments)}(n)}})]})},me=function(){var e=(0,i.zI)(),t=(0,a.Z)(e,2)[1],n=(0,le.vW)(),r=(0,s.useState)(n),c=(0,a.Z)(r,2),l=c[0],o=c[1];return(0,S.jsxs)("div",{className:"profile-page",children:[(0,S.jsx)(Z.Z,{value:l,onChange:function(e){return o(e.target.value)},prefix:(0,S.jsx)(ae.Z,{}),allowClear:!0}),(0,S.jsx)(j.Z,{disabled:n===l||!l,onClick:function(){l&&((0,le.lu)(l),t("MENU"))},type:"primary",block:!0,children:"OK"})]})},he=function(){var e=function(){var e=(0,o.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de().clear();case 2:return e.next=4,(0,oe.eG)();case 4:localStorage.clear(),window.location.reload();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,S.jsx)("div",{className:"setting-menu",children:(0,S.jsx)(v.Z,{title:"Everything will be deleted.",onConfirm:e,icon:(0,S.jsx)(se.Z,{}),okText:"Delete",okType:"danger",okButtonProps:{type:"primary"},cancelText:"Cancel",placement:"bottom",children:(0,S.jsx)(j.Z,{icon:(0,S.jsx)(se.Z,{}),danger:!0,block:!0,children:"Clear all"})})})},Ze=[{key:"PDF",label:"Import PDF",icon:(0,S.jsx)(ce.Z,{})},{key:"PROFILE",label:"My profile",icon:(0,S.jsx)(ae.Z,{})},{key:"SETTINGS",label:"Settings",icon:(0,S.jsx)(u.Z,{})}],je=function(){var e=(0,i.zI)(),t=(0,a.Z)(e,2)[1];return(0,S.jsx)("div",{className:"primary-menu",children:(0,S.jsx)(te.Z,{onClick:function(e){var n=e.key;return t(n)},items:Ze})})},ve=function(e){var t=(0,s.useState)(0),n=(0,a.Z)(t,2),c=n[0],l=n[1],o=(0,i.zI)(),u=(0,a.Z)(o,2),d=u[0],x=u[1],f={timeout:300,onEnter:function(e){l(e.clientHeight)},unmountOnExit:!0};(0,s.useEffect)((function(){return x("MENU")}),[x]);var p={PDF:(0,S.jsx)(pe,(0,r.Z)({},e)),PROFILE:(0,S.jsx)(me,{}),SETTINGS:(0,S.jsx)(he,{})};return(0,S.jsxs)("section",{className:"others-menu",style:{height:c},children:[(0,S.jsx)(U.Z,(0,r.Z)((0,r.Z)({in:"MENU"===d},f),{},{children:(0,S.jsx)(je,{})})),Ze.map((function(e){var t=e.key,n=e.label;return(0,S.jsx)(fe,(0,r.Z)((0,r.Z)({keyName:t,title:n},f),{},{children:p[t]}),t)}))]})},ge=function(e){return(0,S.jsxs)(X.Z,{placement:"bottomRight",trigger:"click",content:(0,S.jsx)(i.s2,{initKey:"",children:(0,S.jsx)(ve,(0,r.Z)({},e))}),zIndex:900,children:[(0,S.jsx)(j.Z,{className:"small",type:"text",icon:(0,S.jsx)(ie.Z,{})}),(0,S.jsx)(j.Z,{className:"large",shape:"circle",icon:(0,S.jsx)(ie.Z,{})})]})},Ne=function(e){return(0,S.jsxs)("nav",{children:[(0,S.jsx)(ke,(0,r.Z)({},e)),(0,S.jsx)(ye,(0,r.Z)({},e))]})},ke=function(e){var t,n,r=e.allTags,s=e.currTagID,c=(0,i.LH)(),l=(0,a.Z)(c,2)[1],o=null!==(t=null===(n=r[s])||void 0===n?void 0:n.name)&&void 0!==t?t:"All notes";return(0,S.jsxs)("div",{className:"nav-left",children:[(0,S.jsx)(j.Z,{className:"aside-btn small",type:"text",icon:(0,S.jsx)(f.Z,{}),onClick:function(){return l(!0)}}),(0,S.jsx)("h2",{children:(0,S.jsx)("b",{children:o})})]})},ye=function(e){return(0,S.jsxs)("div",{className:"nav-right",children:[(0,S.jsx)(be,(0,r.Z)({},e)),(0,S.jsx)(Te,{}),(0,S.jsx)(ge,(0,r.Z)({},e))]})},be=function(e){var t=e.currTagID,n=e.setAllTags,r=e.setAllNotes;function a(){return s.apply(this,arguments)}function s(){return(s=(0,o.Z)((0,l.Z)().mark((function e(){var a,s,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=(0,V.Xn)()).tagID=t,e.next=4,(0,c.au)(a);case 4:s=e.sent,i=s.tags,o=s.allNotes,n(i),r(o);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(j.Z,{className:"new-note large",type:"primary",shape:"round",onClick:a,icon:(0,S.jsx)(Y.Z,{}),children:"New"}),(0,S.jsx)(j.Z,{className:"new-note small",type:"link",onClick:a,icon:(0,S.jsx)(Y.Z,{})})]})},Te=function(){var e=(0,s.useState)(""),t=(0,a.Z)(e,2),n=t[0],r=t[1],c=(0,s.useState)(!1),i=(0,a.Z)(c,2),u=i[0],d=i[1],x=(0,s.useState)(!1),f=(0,a.Z)(x,2),p=f[0],m=f[1],h=(0,G.s0)();function Z(){return(Z=(0,o.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.next=3,(0,_.fI)(t);case 3:if(n=e.sent,d(!1),!n){e.next=7;break}return e.abrupt("return",h("/team/".concat(n)));case 7:r(""),m(!0);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=(0,S.jsxs)("div",{className:"join-team-title",children:[(0,S.jsx)("span",{children:"Join a team note"}),(0,S.jsx)("span",{children:u&&(0,S.jsx)(H.Z,{})})]});return(0,S.jsxs)(X.Z,{placement:"bottomRight",trigger:"click",title:v,destroyTooltipOnHide:!0,onOpenChange:function(){return m(!1)},content:(0,S.jsx)($.GD,{plain:!0,length:4,error:p,value:n,onChange:function(e){m(!1),r(e)},onFill:function(e){return Z.apply(this,arguments)}}),children:[(0,S.jsx)(j.Z,{className:"team-btn large",shape:"round",icon:(0,S.jsx)(Q.Z,{}),children:"Team"}),(0,S.jsx)(j.Z,{className:"team-btn small",type:"text",icon:(0,S.jsx)(Q.Z,{})})]})},Se=n(93433),we=n(37762),Ce=n(60481),Ie=n(68692),De=n(13876),Ee=n(20054),Ae=n(9486),Fe=n(1194),Le=n(74270),Oe=n(11730),Me=function(e){var t=e.sortType,n=e.setSortType,a=e.editing,s=e.setEditing,i=e.searchText,u=e.setSearchText,x=e.selectedNotes,f=e.setAllNotes,p=e.setAllTags,m=e.allTags,h={items:[{type:"group",children:[{icon:(0,S.jsx)(Ie.Z,{}),key:"CREATE",label:"Date created"},{icon:(0,S.jsx)(De.Z,{}),key:"LAST",label:"Date modified"},{icon:(0,S.jsx)(Ee.Z,{}),key:"NAME",label:"Name"}],label:"Sort by",className:"sort-drop"}],onClick:function(e){var t=e.key;n(t)},selectedKeys:[t]},g={type:"text",shape:"circle"},N=(0,S.jsx)(Ce.Z,{menu:h,trigger:["click"],placement:"bottomRight",children:(0,S.jsx)(j.Z,(0,r.Z)({className:"sort-btn",icon:(0,S.jsx)(Ae.Z,{rotate:90})},g))}),k=0===x.size,y=function(){var e=(0,o.Z)((0,l.Z)().mark((function e(){var t,n,r,a,s,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(0,we.Z)(x.toArray()),e.prev=1,r.s();case 3:if((a=r.n()).done){e.next=12;break}return s=a.value,e.next=7,(0,c.f_)(s);case 7:i=e.sent,t=i.tags,n=i.allNotes;case 10:e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:t&&p(t),n&&f(n);case 22:case"end":return e.stop()}}),e,null,[[1,14,17,20]])})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=(0,o.Z)((0,l.Z)().mark((function e(t){var n,r,a,s,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=(0,we.Z)(x.toArray()),e.prev=1,a.s();case 3:if((s=a.n()).done){e.next=12;break}return i=s.value,e.next=7,(0,c.tw)(i,t);case 7:o=e.sent,n=o.tags,r=o.allNotes;case 10:e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),a.e(e.t0);case 17:return e.prev=17,a.f(),e.finish(17);case 20:n&&p(n),r&&f(r);case 22:case"end":return e.stop()}}),e,null,[[1,14,17,20]])})));return function(t){return e.apply(this,arguments)}}(),T=(0,S.jsx)(v.Z,{title:"Notes will be deleted.",onConfirm:y,icon:(0,S.jsx)(d.Z,{}),placement:"bottom",cancelText:"Cancel",disabled:k,okText:"Delete",okType:"danger",okButtonProps:{type:"primary"},children:(0,S.jsx)(j.Z,{className:"del-btn",shape:"round",type:"text",disabled:k,danger:!k,icon:(0,S.jsx)(d.Z,{}),children:"Delete"})}),w=function(e){var t=e.color,n=e.name;return(0,S.jsxs)("div",{className:"tag-select",children:[(0,S.jsx)(E.W,{color:t,className:"tag-circle"}),(0,S.jsx)("span",{className:"name",children:n})]})},C=(0,S.jsx)(te.Z,{onClick:function(e){var t=e.key;return b(t)},items:[{key:"DEFAULT",label:(0,S.jsx)(w,{color:"#eee",name:"No tag"})}].concat((0,Se.Z)(Object.values(m).map((function(e){return{key:e.uid,label:(0,S.jsx)(w,{color:e.color,name:e.name})}}))))}),I=(0,S.jsx)(Ce.Z,{overlayClassName:"tag-drop",disabled:k,overlay:C,trigger:["click"],placement:"bottom",children:(0,S.jsx)(j.Z,{shape:"round",type:"text",className:"tag-btn",icon:(0,S.jsx)(Fe.Z,{}),style:{transition:"none"},children:"Tag"})});return(0,S.jsx)("div",{className:"list-tools","data-editing":a,children:a?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(j.Z,(0,r.Z)({onClick:function(){return s(!1)},icon:(0,S.jsx)(ne.Z,{})},g)),I,T]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(j.Z,(0,r.Z)({onClick:function(){return s(!0)},icon:(0,S.jsx)(Le.Z,{})},g)),(0,S.jsx)(Z.Z,{value:i,onChange:function(e){return u(e.target.value)},className:"search-input",prefix:(0,S.jsx)(Oe.Z,{}),bordered:!1,allowClear:!0}),N]})})},Pe=n(97892),Re=n.n(Pe),Ue=n(6593),ze=n.n(Ue),Be=n(74689);Re().extend(ze());var He=function(e){var t=(0,s.useState)(!1),n=(0,a.Z)(t,2),i=n[0],u=n[1],d=(0,s.useState)("LAST"),x=(0,a.Z)(d,2),f=x[0],p=x[1],m=(0,s.useState)(""),h=(0,a.Z)(m,2),Z=h[0],j=h[1],v=(0,s.useState)((0,K.Set)()),g=(0,a.Z)(v,2),N=g[0],k=g[1],y=e.setAllTags,b=e.setAllNotes,T=function(){var e=(0,o.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.f_)(t);case 2:n=e.sent,r=n.tags,a=n.allNotes,b(a),y(r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=e.currTagID,C=e.allNotes,E=e.allTags,A=(0,s.useMemo)((function(){var e,t;return(0,K.List)((null!==(e=null===(t=E[w])||void 0===t?void 0:t.notes)&&void 0!==e?e:Object.keys(C)).map((function(e){return C[e]})).filter((function(e){return void 0!==e})))}),[C,E,w]),F=(0,s.useMemo)((function(){var e=function(e,t){return t-e};switch(f){case"CREATE":return A.sortBy((function(e){return e.createTime}),e);case"LAST":return A.sortBy((function(e){return e.lastTime}),e);case"NAME":return A.sortBy((function(e){return e.name.toUpperCase()}));default:return A}}),[A,f]),L=(0,s.useMemo)((function(){return F.filter((function(e){return e.name.toUpperCase().includes(Z.trim().toUpperCase())}))}),[Z,F]);(0,s.useEffect)((function(){j(""),k((0,K.Set)())}),[A,i]);var O=(0,s.useState)(!0),M=(0,a.Z)(O,2),P=M[0],z=M[1];return(0,s.useEffect)((function(){var e=setTimeout((function(){return z(!1)}),500);return function(){return clearTimeout(e)}}),[]),(0,S.jsxs)("div",{className:"note-list",children:[(0,S.jsxs)("header",{children:[(0,S.jsx)(Ne,(0,r.Z)({},e)),(0,S.jsx)(Me,(0,r.Z)({sortType:f,setSortType:p,editing:i,setEditing:u,searchText:Z,setSearchText:j,selectedNotes:N},e))]}),(0,S.jsx)(I,{children:(0,S.jsx)(R.Z,{component:null,children:L.map((function(t,n){var a,s=t.uid,c=N.has(s),l=null===(a=L.get(n+1))||void 0===a?void 0:a.uid,o=(l&&N.has(l))!==c;return(0,S.jsx)(U.Z,{timeout:300,children:function(n){return(0,S.jsx)(D,{className:"note-wrapper",onDelete:function(){return T(s)},disable:i,"data-last":o,"data-selected":c,"data-init":P,children:(0,S.jsx)(We,(0,r.Z)({timgShow:/^(entered|exiting)$/.test(n),noteInfo:t,selected:c,editing:i,setSelectNotes:k},e))})}},s)}))})})]})},We=function(e){var t=e.noteInfo,n=e.selected,i=e.editing,l=e.setSelectNotes,o=e.setAllNotes,u=e.allTags,d=e.currTagID,x=e.timgShow,f=t.team,p=t.uid,m=t.name,h=t.lastTime,j=t.tagID,v=(0,s.useMemo)((function(){return Re()(h).calendar()}),[h]),N="".concat(f?"team":"reader","/").concat(p),k=(0,s.useState)(m),y=(0,a.Z)(k,2),b=y[0],T=y[1],w=(0,G.s0)(),C=u[j];return(0,S.jsxs)("div",{className:"note-item","data-selected":n,onClick:function(){if(!i)return w(N);l((function(e){return e.has(p)?e.delete(p):e.add(p)}))},children:[(0,S.jsxs)("div",{className:"left",children:[x&&(0,S.jsx)(Ke,{uid:p}),f&&(0,S.jsx)(z.Z,{className:"cloud-icon"}),(0,S.jsx)(B.Z,{className:"checked-icon"})]}),(0,S.jsxs)("div",{className:"content",children:[i&&!n?(0,S.jsx)(Z.Z,{className:"name-input",value:b,onChange:function(e){return T(e.target.value)},onClick:function(e){return e.stopPropagation()},onBlur:function(){var e=b.trim();if(!e||e===m)return T(m);(0,c.SP)(p,{name:e}),o((function(n){return(0,r.Z)((0,r.Z)({},n),{},(0,P.Z)({},p,(0,r.Z)((0,r.Z)({},t),{},{name:e})))}))}}):(0,S.jsx)("p",{className:"name",children:m}),(0,S.jsxs)("p",{className:"info",children:[(0,S.jsx)("span",{className:"date",children:v}),C&&"DEFAULT"===d&&(0,S.jsx)("span",{className:"tag",style:(0,g.MW)(C.color),children:C.name})]})]})]})},Ge=s.lazy((function(){return Promise.all([n.e(295),n.e(199),n.e(750)]).then(n.bind(n,27199))})),Ke=function(e){var t,n=e.uid,r=(0,s.useState)(),i=(0,a.Z)(r,2),l=i[0],o=i[1],u=(0,s.useState)(),d=(0,a.Z)(u,2),x=d[0],f=d[1];(0,s.useEffect)((function(){(0,c.U9)(n).then(o),(0,_.ox)(n).then(f)}),[n]);var p=null!==(t=null===l||void 0===l?void 0:l.pageOrder[0])&&void 0!==t?t:"",m=null===l||void 0===l?void 0:l.pageRec[p],h=(0,s.useMemo)((function(){if(m){var e=m.state,t=m.ratio;return W.DrawState.loadFromFlat(e,t,Be.m)}}),[m]),Z=(0,s.useMemo)((function(){if(x&&p)return J.f.createFromTeamPages(x).getOnePageStateMap(p)}),[x,p]);if(!m||!h)return null;var j=m.ratio,v=m.image;return(0,S.jsx)("div",{className:"timg-wrapper","data-landscape":j<1,children:(0,S.jsx)(s.Suspense,{fallback:(0,S.jsx)(H.Z,{style:{opacity:.5}}),children:(0,S.jsx)(Ge,{drawState:h,teamStateMap:Z,thumbnail:v,preview:!0})})})};function _e(){return(_e=(0,o.Z)((0,l.Z)().mark((function e(){var t,r,a,s,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="INTRO_CREATED",!localStorage.getItem(t)){e.next=3;break}return e.abrupt("return");case 3:if((r=(0,V.Xn)()).name="Welcome to Multibility!",a=Object.values(r.pageRec)[0]){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,n.e(925).then(n.t.bind(n,43925,17));case 10:return s=e.sent,i=s.default,a.state=JSON.parse(i),localStorage.setItem(t,"CREATED"),e.next=16,(0,c.au)(r);case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Je(){var e=(0,s.useState)({}),t=(0,a.Z)(e,2),n=t[0],l=t[1],o=(0,s.useState)({}),u=(0,a.Z)(o,2),d=u[0],x=u[1],f=(0,s.useState)("DEFAULT"),p=(0,a.Z)(f,2),m=p[0],h=p[1];(0,s.useEffect)((function(){(0,c.hY)().then(l),(0,c.Ys)().then(x),document.title="Multibility"}),[]),(0,s.useEffect)((function(){(function(){return _e.apply(this,arguments)})().then((function(e){if(e){var t=e.tags,n=e.allNotes;x(t),l(n)}}))}),[]);var Z={allNotes:n,allTags:d,setAllNotes:l,setAllTags:x,currTagID:m,setCurrTagID:h};return(0,S.jsx)("div",{className:"main-menu container",children:(0,S.jsxs)(i.kV,{children:[(0,S.jsx)(M,(0,r.Z)({},Z)),(0,S.jsx)(He,(0,r.Z)({},Z))]})})}}}]);
//# sourceMappingURL=137.5a02f21d.chunk.js.map