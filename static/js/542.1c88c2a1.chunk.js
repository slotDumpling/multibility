"use strict";(self.webpackChunkmultibility=self.webpackChunkmultibility||[]).push([[542],{35873:function(t,e,r){r.d(e,{W:function(){return s}});var n=r(81694),a=r.n(n),u=r(80184),s=function(t){var e=t.color,r=t.className,n={backgroundColor:e};return(0,u.jsx)("div",{className:a()("color-circle",r),style:n})}},74115:function(t,e,r){r.d(e,{MW:function(){return f},O9:function(){return u},Qk:function(){return s},bM:function(){return c},mr:function(){return i}});var n=r(45917),a=r.n(n),u=["#f97316","#eab308","#84cc16","#22c55e","#10b981","#14b8a6","#06b6d4","#0ea5e9","#3b82f6","#6366f1","#8b5cf6","#a855f7","#d946ef","#ec4899","#f43f5e","#ef4444"],s=[].concat(["#000000","#9ca3af","#64748b","#78716c"],u),i=function(){var t=Math.floor(Math.random()*u.length);return u[t]},c=function(t){var e=a()(t)%u.length;return u[e]},o={"#f97316":{light:"#FFEDD5",dark:"#9A3412"},"#eab308":{light:"#FEF9C3",dark:"#854D0E"},"#84cc16":{light:"#ECFCCB",dark:"#3F6212"},"#22c55e":{light:"#DCFCE7",dark:"#166534"},"#10b981":{light:"#D1FAE5",dark:"#065F46"},"#14b8a6":{light:"#CCFBF1",dark:"#115E59"},"#06b6d4":{light:"#CFFAFE",dark:"#155E75"},"#0ea5e9":{light:"#E0F2FE",dark:"#075985"},"#3b82f6":{light:"#DBEAFE",dark:"#1E40AF"},"#6366f1":{light:"#E0E7FF",dark:"#3730A3"},"#8b5cf6":{light:"#EDE9FE",dark:"#5B21B6"},"#a855f7":{light:"#F3E8FF",dark:"#6B21A8"},"#d946ef":{light:"#FAE8FF",dark:"#86198F"},"#ec4899":{light:"#FCE7F3",dark:"#9D174D"},"#f43f5e":{light:"#FFE4E6",dark:"#9F1239"},"#ef4444":{light:"#FEE2E2",dark:"#991B1B"}},f=function(t){var e,r=null!==(e=o[t])&&void 0!==e?e:{light:"#E5E7EB",dark:"#374151"};return{"--light-color":r.light,"--dark-color":r.dark}}},82670:function(t,e,r){r.d(e,{Dw:function(){return k},F:function(){return m},mF:function(){return h}});var n=r(1413),a=r(29439),u=r(15671),s=r(43144),i=r(24124),c=r(49030),o=r(85283),f=r(43763),p=r(69962),l=r(25641),d=r.n(l),h=2e3,g={strokes:(0,i.zN)(),undoStack:(0,i.aV)(),historyStack:(0,i.aV)()},v=(0,i.WV)(g),m=function(){return{strokes:{}}},k=function(){function t(e,r,n,a){(0,u.Z)(this,t),this.immutable=e,this.width=r,this.height=n,this.lastOp=a}return(0,s.Z)(t,[{key:"getImmutable",value:function(){return this.immutable}},{key:"getUndoStack",value:function(){return this.getImmutable().get("undoStack")}},{key:"getHistoryStack",value:function(){return this.getImmutable().get("historyStack")}},{key:"getStrokeMap",value:function(){return this.getImmutable().get("strokes")}},{key:"getStrokeList",value:function(){return this.getStrokeMap().toArray().map((function(t){var e=(0,a.Z)(t,2);e[0];return e[1]}))}},{key:"getLastStroke",value:function(){return this.getStrokeMap().last()}},{key:"isEmpty",value:function(){return 0===this.getStrokeMap().size}},{key:"hasStroke",value:function(t){return this.getStrokeMap().has(t)}}],[{key:"createEmpty",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;return new t(v(),r,r*e)}},{key:"undo",value:function(e){var r=e.getHistoryStack().last();if(!r)return e;var n=e.getUndoStack().unshift(e.getImmutable());return new t(r.set("undoStack",n),e.width,e.height,{type:"undo"})}},{key:"redo",value:function(e){var r=e.getUndoStack().first();return r?new t(r,e.width,e.height,{type:"redo"}):e}},{key:"addStroke",value:function(e,r){var n={pathData:r,uid:(0,c.Z)(),timestamp:Date.now()};return t.pushStroke(e,n)}},{key:"addStrokes",value:function(e,r,n){return t.mutateStrokes(e,r.map((function(t){var e=(0,c.Z)();return null===n||void 0===n||n.push(e),[e,t]})))}},{key:"pushStroke",value:function(e,r){var n=r.uid,a=e.getImmutable(),u=a.update("strokes",(function(t){return t.set(n,r)})).update("historyStack",(function(t){return t.push(a)})).delete("undoStack"),s={type:"add",stroke:r};return new t(u,e.width,e.height,s)}},{key:"eraseStrokes",value:function(e,r){if(0===r.length)return e;var n=e.getImmutable(),a=e.getStrokeMap(),u=r.filter((function(t){return!a.has(t)}));a=a.deleteAll(r),u.forEach((function(t){var e=(0,c.Z)();a=a.set(e,{uid:e,timestamp:Date.now(),pathData:"HIDE_"+t})}));var s={type:"erase",erased:r};return new t(n.set("strokes",a).update("historyStack",(function(t){return t.push(n)})).delete("undoStack"),e.width,e.height,s)}},{key:"mutateStrokes",value:function(e,r){if(0===r.length)return e;var u=e.getImmutable(),s=e.getStrokeMap();r.forEach((function(t){var e=(0,a.Z)(t,2),r=e[0],u=e[1];return s=s.update(r,{uid:r,pathData:u,timestamp:Date.now()},(function(t){return(0,n.Z)((0,n.Z)({},t),{},{pathData:u})}))}));var i={type:"mutate",mutations:r};return new t(u.set("strokes",s).update("historyStack",(function(t){return t.push(u)})).delete("undoStack"),e.width,e.height,i)}},{key:"splitStrokes",value:function(e,r){if(0===r.length)return e;var n=(0,i.D5)(r),a=(0,i.zN)();e.getStrokeMap().forEach((function(t,e){var r=n.get(e);a=r?a.merge(r.map((function(r,n){(0,o.Z)(e)||(e=(0,f.Z)(e,p.Z));var a=(0,f.Z)(String(n),e);return[a,{pathData:r,timestamp:t.timestamp,uid:a}]}))):a.set(e,t)}));var u=e.getImmutable(),s={type:"split",splitters:r};return new t(u.set("strokes",a).update("historyStack",(function(t){return t.push(u)})),e.width,e.height,s)}},{key:"syncStrokeTime",value:function(t,e,r){var n=t.getStrokeMap().get(e);n&&(n.timestamp=r)}},{key:"pushOperation",value:function(e,r){switch(r.type){case"add":return t.pushStroke(e,r.stroke);case"erase":return t.eraseStrokes(e,r.erased);case"mutate":return t.mutateStrokes(e,r.mutations);case"undo":return t.undo(e);case"redo":return t.redo(e);case"split":return t.splitStrokes(e,r.splitters)}}},{key:"flaten",value:function(t){return{strokes:t.getImmutable().get("strokes").toObject()}}},{key:"loadFromFlat",value:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h,a=e.strokes,u=e.operations,s=new t(v().set("strokes",(0,i.zN)(a)),n,n*r);return null===u||void 0===u||u.forEach((function(e){return s=t.pushOperation(s,e)})),s}},{key:"mergeStates",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e.map((function(t){return t.getStrokeMap().values()})),u=(0,i.zN)(),s=new(d())((function(t,e){var r=(0,a.Z)(t,1)[0],n=(0,a.Z)(e,1)[0];return r.timestamp-n.timestamp}));for(n.forEach((function(t,e){var r=t.next(),n=r.value;r.done||s.push([n,e])}));s.size()>0;){var c=s.pop();if(!c)break;var o=(0,a.Z)(c,2),f=o[0],p=o[1],l=f.uid,h=f.pathData;if(/^HIDE_/.test(h)){var g=h.slice(5);u=u.delete(g)}else u=u.set(l,f);var v=n[p];if(!v)break;var m=v.next(),k=m.value,b=m.done;b||s.push([k,p])}return u}}]),t}()},79856:function(t,e,r){r.d(e,{f:function(){return l}});var n=r(29439),a=r(45987),u=r(15671),s=r(43144),i=r(82670),c=r(24124),o=["pageID"],f={pageStates:(0,c.D5)(),pageInfos:(0,c.D5)()},p=(0,c.WV)(f),l=function(){function t(e){(0,u.Z)(this,t),this.immutable=e}return(0,s.Z)(t,[{key:"getImmutable",value:function(){return this.immutable}},{key:"getPageStates",value:function(){return this.getImmutable().get("pageStates")}},{key:"getPageInfos",value:function(){return this.getImmutable().get("pageInfos")}},{key:"getOneState",value:function(t,e){var r;return null===(r=this.getPageStates().get(t))||void 0===r?void 0:r.get(e)}},{key:"getOnePageStateMap",value:function(t){return this.getPageStates().get(t)}},{key:"getPageRatio",value:function(t){var e;return null===(e=this.getPageInfos().get(t))||void 0===e?void 0:e.ratio}},{key:"includesPage",value:function(t){return this.getPageStates().has(t)}},{key:"setState",value:function(e,r,n){var a=this.getPageStates().get(e);return a?new t(this.getImmutable().update("pageStates",(function(t){return t.set(e,a.set(r,n))}))):this}},{key:"addPage",value:function(e,r){var n=r.ratio;return new t(this.getImmutable().update("pageStates",(function(t){return t.set(e,(0,c.D5)())})).update("pageInfos",(function(t){return t.set(e,{ratio:n})})))}},{key:"pushOperation",value:function(t,e){var r=t.pageID,n=(0,a.Z)(t,o),u=this.getPageRatio(r);if(!this.includesPage(r)||!u)return this;var s=this.getOneState(r,e)||i.Dw.createEmpty(u),c=i.Dw.pushOperation(s,n);return this.setState(r,e,c)}},{key:"resetUser",value:function(t,e){for(var r=this,a=0,u=Object.entries(e);a<u.length;a++){var s=(0,n.Z)(u[a],2),c=s[0],o=s[1],f=o.state,p=o.ratio;r.getOneState(c,t)&&(r=r.setState(c,t,i.Dw.loadFromFlat(f,p)))}return r}}],[{key:"createFromTeamPages",value:function(e){var r=p();return Object.entries(e).forEach((function(t){var e=(0,n.Z)(t,2),a=e[0],u=e[1],s=u.states,o=u.ratio,f=(0,c.D5)(Object.entries(s).map((function(t){var e=(0,n.Z)(t,2),r=e[0],a=e[1];return[r,i.Dw.loadFromFlat(a,o)]})));r=r.update("pageStates",(function(t){return t.set(a,f)})).update("pageInfos",(function(t){return t.set(a,{ratio:o})}))})),new t(r)}},{key:"getValidUsers",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,c.l4)();return t?Array.from(t.filter((function(t){return!t.isEmpty()})).deleteAll(e).keys()):[]}},{key:"isEmpty",value:function(t){return!t||t.every((function(t){return t.isEmpty()}))}}]),t}()},52365:function(t,e,r){r.d(e,{LH:function(){return p},kV:function(){return l},mf:function(){return s},s2:function(){return o},zI:function(){return c}});var n=r(29439),a=r(72791),u=r(80184);function s(t){var e=t.propertyName,r=t.active,u=void 0===r||r,s=(0,a.useRef)((function(){})),i=(0,a.useState)((function(){return new Promise((function(t){return s.current=t}))}));return[(0,n.Z)(i,1)[0],function(t){t.propertyName===e&&u&&s.current()}]}var i=(0,a.createContext)(["",function(){}]);function c(){var t=(0,a.useContext)(i);return(0,a.useDebugValue)(t[0]),t}var o=function(t){var e=t.children,r=t.initKey,n=(0,a.useState)(r);return(0,u.jsx)(i.Provider,{value:n,children:e})},f=(0,a.createContext)([!1,function(){}]);function p(){var t=(0,a.useContext)(f);return(0,a.useDebugValue)(t[0]),t}var l=function(t){var e=t.children,r=(0,a.useState)(!1);return(0,u.jsx)(f.Provider,{value:r,children:e})}},51570:function(t,e,r){r.d(e,{CD:function(){return O},_n:function(){return m},dn:function(){return Z},f1:function(){return D},fI:function(){return k},ox:function(){return N},r8:function(){return w}});var n,a=r(45987),u=r(74165),s=r(15861),i=r(74569),c=r.n(i),o=r(92198),f=r(75783),p=r(69951),l=r(61842),d=r.n(l),h=r(83329),g=r.n(h),v=["statusCode"],m=null!==(n="https://api.slotdumpling.top/paint")?n:"";function k(t){return b.apply(this,arguments)}function b(){return(b=(0,s.Z)((0,u.Z)().mark((function t(e){var r,n;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c().get("code/".concat(e));case 3:if(r=t.sent,200===(n=r.data).statusCode){t.next=7;break}return t.abrupt("return",null);case 7:return t.abrupt("return",n.noteID);case 10:return t.prev=10,t.t0=t.catch(0),console.error(t.t0),t.abrupt("return",null);case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function x(t){return y.apply(this,arguments)}function y(){return(y=(0,s.Z)((0,u.Z)().mark((function t(e){var r,n,s,i,o;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c().get("info/".concat(e));case 3:if(r=t.sent,n=r.data,i=(s=n).statusCode,o=(0,a.Z)(s,v),200===i){t.next=8;break}return t.abrupt("return",null);case 8:return t.abrupt("return",o);case 11:return t.prev=11,t.t0=t.catch(0),console.error(t.t0),t.abrupt("return",null);case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))).apply(this,arguments)}function Z(t,e){return S.apply(this,arguments)}function S(){return(S=(0,s.Z)((0,u.Z)().mark((function t(e,r){var n,a,s,i,o,p;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x(e);case 3:if(n=t.sent){t.next=6;break}return t.abrupt("return",null);case 6:return a=n.noteInfo,s=n.pageInfos,t.next=9,(0,f.Rb)(e,a,s);case 9:if(!t.sent){t.next=11;break}return t.abrupt("return",n);case 11:if(!a.withImg){t.next=21;break}return t.next=14,c()({method:"GET",url:e,responseType:"blob",onDownloadProgress:function(t){var e=t.loaded;null===r||void 0===r||r(e)}});case 14:return i=t.sent,o=i.data,p=new Blob([o],{type:"application/pdf"}),t.next=19,(0,f.Vk)(e,a,s,p);case 19:t.next=23;break;case 21:return t.next=23,(0,f.Vk)(e,a,s);case 23:return t.abrupt("return",n);case 26:return t.prev=26,t.t0=t.catch(0),console.error(t.t0),t.abrupt("return",null);case 30:case"end":return t.stop()}}),t,null,[[0,26]])})))).apply(this,arguments)}function w(t){return I.apply(this,arguments)}function I(){return(I=(0,s.Z)((0,u.Z)().mark((function t(e){var r,n,a,s,i,l,d,h,g,v,m,k;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,f.U9)(e);case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return",!1);case 5:return n=r.uid,a=r.name,s=r.withImg,i=r.pdf,l=r.pageOrder,d=r.pageRec,(0,o.Yl)(d),t.prev=7,t.next=10,c().put("create/".concat(e),{userID:(0,p.VN)(),pageRec:d,noteInfo:{uid:n,name:a,withImg:s,pageOrder:l}});case 10:if(h=t.sent,g=h.data,!i){t.next=21;break}return v=new FormData,t.next=16,i.arrayBuffer();case 16:return m=t.sent,k=new Blob([m]),v.append("file",k,e),t.next=21,c()({method:"POST",url:"upload",data:v,headers:{"Content-Type":"multipart/form-data"}});case 21:if(201===g.statusCode){t.next=23;break}return t.abrupt("return",!1);case 23:return t.abrupt("return",!0);case 26:return t.prev=26,t.t0=t.catch(7),console.error(t.t0),t.abrupt("return",!1);case 30:case"end":return t.stop()}}),t,null,[[7,26]])})))).apply(this,arguments)}c().defaults.baseURL=m;var E=d().createInstance({name:"updateHash"});function D(t){return F.apply(this,arguments)}function F(){return(F=(0,s.Z)((0,u.Z)().mark((function t(e){var r,n,a,s,i,l,d,h,v,m,k;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,f.U9)(e);case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return",null);case 5:return n=r.uid,a=r.name,s=r.withImg,i=r.pageOrder,l=r.pageRec,(0,o.Yl)(l),d={uid:n,name:a,withImg:s,pageOrder:i},h=g()(JSON.stringify([l,d])),t.next=11,E.getItem(e);case 11:if(v=t.sent,h!==v){t.next=14;break}return t.abrupt("return",!0);case 14:return t.prev=14,m={userID:(0,p.VN)(),pageRec:l,noteInfo:d},t.next=18,c().put("update/".concat(e),m);case 18:if(k=t.sent,201===k.data.statusCode){t.next=22;break}return t.abrupt("return",!1);case 22:return t.next=24,E.setItem(e,h);case 24:return t.abrupt("return",!0);case 27:return t.prev=27,t.t0=t.catch(14),console.error(t.t0),t.abrupt("return",!1);case 31:case"end":return t.stop()}}),t,null,[[14,27]])})))).apply(this,arguments)}var A=d().createInstance({name:"teamState"});function O(t,e){return L.apply(this,arguments)}function L(){return(L=(0,s.Z)((0,u.Z)().mark((function t(e,r){var n,a,s,i,o,f,l;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N(e);case 2:return n=t.sent,a=n&&g()(JSON.stringify(n)),t.prev=4,t.next=7,c().get("state/".concat(e),{params:{userID:(0,p.VN)(),hash:a},onDownloadProgress:function(t){var e=t.loaded;null===r||void 0===r||r(e)}});case 7:if(s=t.sent,i=s.data,o=i.statusCode,f=i.modified,l=i.teamPages,200!==o||!f){t.next=14;break}return t.next=13,A.setItem(e,l);case 13:return t.abrupt("return",l);case 14:return t.abrupt("return",n);case 17:return t.prev=17,t.t0=t.catch(4),console.error(t.t0),t.abrupt("return",n);case 21:case"end":return t.stop()}}),t,null,[[4,17]])})))).apply(this,arguments)}function N(t){return P.apply(this,arguments)}function P(){return(P=(0,s.Z)((0,u.Z)().mark((function t(e){var r;return(0,u.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.getItem(e);case 2:if(t.t1=r=t.sent,t.t0=null!==t.t1,!t.t0){t.next=6;break}t.t0=void 0!==r;case 6:if(!t.t0){t.next=10;break}t.t2=r,t.next=11;break;case 10:t.t2=void 0;case 11:return t.abrupt("return",t.t2);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},75783:function(t,e,r){r.d(e,{HO:function(){return Z},Pn:function(){return w},Rb:function(){return j},SP:function(){return O},U9:function(){return F},Vk:function(){return V},Ys:function(){return x},au:function(){return T},f_:function(){return C},hY:function(){return k},tk:function(){return E},tw:function(){return M}});var n=r(29439),a=r(45987),u=r(49142),s=r(4942),i=r(1413),c=r(74165),o=r(15861),f=r(82670),p=r(61842),l=r.n(p),d=r(49030),h=r(763),g=["pageRec","pageOrder"],v=["pdf"],m=["pageRec","pageOrder"];function k(){return b.apply(this,arguments)}function b(){return(b=(0,o.Z)((0,c.Z)().mark((function t(){var e;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l().getItem("ALL_NOTES");case 2:if(!(e=t.sent)){t.next=5;break}return t.abrupt("return",e);case 5:return l().setItem("ALL_NOTES",{}),t.abrupt("return",{});case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function x(){return y.apply(this,arguments)}function y(){return(y=(0,o.Z)((0,c.Z)().mark((function t(){var e;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l().getItem("ALL_TAGS");case 2:if(!(e=t.sent)){t.next=5;break}return t.abrupt("return",e);case 5:return l().setItem("ALL_TAGS",{}),t.abrupt("return",{});case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Z(t,e){return S.apply(this,arguments)}function S(){return(S=(0,o.Z)((0,c.Z)().mark((function t(e,r){var n,a,u,o;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,d.Z)(),a={uid:n,name:e,color:r,notes:[]},t.next=4,x();case 4:return u=t.sent,o=(0,i.Z)((0,i.Z)({},u),{},(0,s.Z)({},n,a)),t.next=8,l().setItem("ALL_TAGS",o);case 8:return t.abrupt("return",o);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function w(t){return I.apply(this,arguments)}function I(){return(I=(0,o.Z)((0,c.Z)().mark((function t(e){var r,n;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:return r=t.sent,r[e],n=(0,a.Z)(r,[e].map(u.Z)),t.next=6,l().setItem("ALL_TAGS",n);case 6:return t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function E(t){return D.apply(this,arguments)}function D(){return(D=(0,o.Z)((0,c.Z)().mark((function t(e){var r,n;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x();case 2:return r=t.sent,n=(0,i.Z)((0,i.Z)({},r),{},(0,s.Z)({},e.uid,e)),t.next=6,l().setItem("ALL_TAGS",n);case 6:return t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function F(t){return A.apply(this,arguments)}function A(){return(A=(0,o.Z)((0,c.Z)().mark((function t(e){var r,n;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l().getItem(e);case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,l().getItem("PDF_".concat(e));case 7:if(!(n=t.sent)){t.next=12;break}return t.abrupt("return",(0,i.Z)((0,i.Z)({},r),{},{pdf:n}));case 12:return t.abrupt("return",r);case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function O(t,e){return L.apply(this,arguments)}function L(){return(L=(0,o.Z)((0,c.Z)().mark((function t(e,r){var n,u,s,o,f;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"pageRec"in(r=(0,h.pickBy)(r,(function(t){return void 0!==t})))&&(r.lastTime=Date.now()),t.next=4,k();case 4:if(n=t.sent,(u=r).pageRec,u.pageOrder,s=(0,a.Z)(u,g),o=n[e]){t.next=9;break}return t.abrupt("return");case 9:return n[e]=(0,i.Z)((0,i.Z)({},o),s),t.next=12,l().setItem("ALL_NOTES",n);case 12:return t.next=14,F(e);case 14:if(f=t.sent){t.next=17;break}return t.abrupt("return");case 17:return t.next=19,l().setItem(e,(0,i.Z)((0,i.Z)({},f),r));case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function N(t){return P.apply(this,arguments)}function P(){return(P=(0,o.Z)((0,c.Z)().mark((function t(e){var r,n,a,u,s;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.uid,n=e.tagID,t.next=3,k();case 3:return(a=t.sent)[r]=e,t.next=7,l().setItem("ALL_NOTES",a);case 7:return t.next=9,x();case 9:if(u=t.sent,!(s=u[n])){t.next=15;break}return s.notes.push(e.uid),t.next=15,l().setItem("ALL_TAGS",u);case 15:return t.abrupt("return",{tags:u,allNotes:a});case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function T(t){return _.apply(this,arguments)}function _(){return(_=(0,o.Z)((0,c.Z)().mark((function t(e){var r,n,u;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.pdf,n=(0,a.Z)(e,v),t.next=3,l().setItem(n.uid,n);case 3:if(!r){t.next=6;break}return t.next=6,l().setItem("PDF_".concat(n.uid),r);case 6:return n.pageRec,n.pageOrder,u=(0,a.Z)(n,m),t.next=9,N(u);case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function C(t){return R.apply(this,arguments)}function R(){return(R=(0,o.Z)((0,c.Z)().mark((function t(e){var r,n,a,u,s;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F(e);case 2:return r=t.sent,t.next=5,k();case 5:return n=t.sent,t.next=8,x();case 8:if(a=t.sent,r){t.next=11;break}return t.abrupt("return",{tags:a,allNotes:n});case 11:return t.next=13,l().removeItem(e);case 13:return t.next=15,l().removeItem("PDF_".concat(e));case 15:return delete n[e],t.next=18,l().setItem("ALL_NOTES",n);case 18:if(u=r.tagID,!(s=a[u])){t.next=24;break}return s.notes=s.notes.filter((function(t){return t!==e})),t.next=24,l().setItem("ALL_TAGS",a);case 24:return t.abrupt("return",{tags:a,allNotes:n});case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function M(t,e){return U.apply(this,arguments)}function U(){return(U=(0,o.Z)((0,c.Z)().mark((function t(e,r){var n,a,u,s,i,o,f;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F(e);case 2:return a=t.sent,t.next=5,k();case 5:return u=t.sent,t.next=8,x();case 8:if(s=t.sent,i=u[e],a&&i){t.next=12;break}return t.abrupt("return",{tags:s,allNotes:u});case 12:return o=a.tagID,a.tagID=r,t.next=16,l().setItem(e,a);case 16:return i.tagID=r,t.next=19,l().setItem("ALL_NOTES",u);case 19:return(f=s[o])&&(f.notes=f.notes.filter((function(t){return t!==e}))),null===(n=s[r])||void 0===n||n.notes.push(e),t.next=24,l().setItem("ALL_TAGS",s);case 24:return t.abrupt("return",{tags:s,allNotes:u});case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function V(t,e,r,n){return B.apply(this,arguments)}function B(){return(B=(0,o.Z)((0,c.Z)().mark((function t(e,a,u,s){var o,p,l,d,h,g,v;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F(e);case 2:if(!(o=t.sent)){t.next=5;break}return t.abrupt("return");case 5:if(p=Date.now(),l={},o=(0,i.Z)((0,i.Z)({},a),{},{tagID:"DEFAULT",team:!0,pageRec:l,pdf:s,createTime:p,lastTime:p}),Object.entries(u).forEach((function(t){var e=(0,n.Z)(t,2),r=e[0],a=e[1];l[r]=(0,i.Z)((0,i.Z)({},a),{},{state:(0,f.F)()})})),!s){t.next=19;break}return t.next=12,Promise.all([r.e(574),r.e(643),r.e(701)]).then(r.bind(r,21176));case 12:return d=t.sent,h=d.getPDFImages,t.next=16,h(s,.5);case 16:g=t.sent,v=g.images,Object.values(l).forEach((function(t){var e=t.pdfIndex;e&&(t.image=v[e-1])}));case 19:return t.next=21,T(o);case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function j(t,e,r){return G.apply(this,arguments)}function G(){return(G=(0,o.Z)((0,c.Z)().mark((function t(e,a,u){var s,o,p,l,d,h,g,v,m,k,b,x,y,Z;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F(e);case 2:if(s=t.sent){t.next=5;break}return t.abrupt("return",!1);case 5:return o=a.pageOrder,p=s.pageRec,l=s.pdf,t.next=9,Promise.all([r.e(574),r.e(643),r.e(701)]).then(r.bind(r,21176));case 9:d=t.sent,h=d.getOneImage,g=0,v=Object.entries(u);case 12:if(!(g<v.length)){t.next=27;break}if(m=(0,n.Z)(v[g],2),k=m[0],b=m[1],!(k in p)){t.next=16;break}return t.abrupt("continue",24);case 16:if(x=b.pdfIndex,y=(0,f.F)(),Z=(0,i.Z)((0,i.Z)({},b),{},{state:y}),p[k]=Z,!l||!x){t.next=24;break}return t.next=23,h(l,x,.5);case 23:Z.image=t.sent;case 24:g++,t.next=12;break;case 27:return t.next=29,O(e,{pageOrder:o,pageRec:p});case 29:return t.abrupt("return",!0);case 30:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},92198:function(t,e,r){r.d(e,{BJ:function(){return c},D4:function(){return f},Xn:function(){return o},Yl:function(){return p}});var n=r(4942),a=r(82670),u=r(49030),s=r(97892),i=r.n(s),c={ratio:1.5,state:{strokes:{}}};function o(){var t=(0,u.Z)(),e=Date.now();return{uid:(0,u.Z)(),name:"Note ".concat(i()(e).format("HH:mm, ddd MMM D")),tagID:"DEFAULT",team:!1,withImg:!1,createTime:e,lastTime:e,pageRec:(0,n.Z)({},t,{ratio:1.5,state:(0,a.F)()}),pageOrder:[t]}}function f(t){return[(0,u.Z)(),null!==t&&void 0!==t?t:{ratio:1.5,state:(0,a.F)()}]}function p(t){Object.values(t).forEach((function(t){delete t.image,delete t.marked}))}},69951:function(t,e,r){r.d(e,{VN:function(){return a},lu:function(){return s},vW:function(){return u}});var n=r(49030),a=function(){var t;return function(){if(t)return t;var e=localStorage.getItem("USER_ID");return e||(e=(0,n.Z)(),localStorage.setItem("USER_ID",e)),t=e,e}}(),u=function(){var t=localStorage.getItem("USER_NAME");return t||(t=(0,n.Z)().slice(0,8),localStorage.setItem("USER_NAME",t)),t},s=function(t){return!!(t=t.trim())&&(localStorage.setItem("USER_NAME",t),!0)}}}]);
//# sourceMappingURL=542.1c88c2a1.chunk.js.map